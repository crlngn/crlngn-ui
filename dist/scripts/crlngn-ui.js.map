{"version":3,"file":"crlngn-ui.js","sources":["../../src/constants/Hooks.mjs","../../src/constants/General.mjs","../../src/components/LogUtil.mjs","../../src/constants/Settings.mjs","../../src/components/settings-dialogs/CameraDockSettings.mjs","../../src/components/settings-dialogs/ChatMessagesSettings.mjs","../../src/components/GeneralUtil.mjs","../../src/components/settings-dialogs/CustomFontSettings.mjs","../../src/components/settings-dialogs/LeftControlsSettings.mjs","../../src/components/settings-dialogs/SceneNavSettings.mjs","../../src/components/settings-dialogs/ThemeAndStylesSettings.mjs","../../src/constants/SettingMenus.mjs","../../src/components/CameraUtil.mjs","../../src/components/ChatUtil.mjs","../../src/components/ModuleCompatUtil.mjs","../../src/components/SceneFoldersUtil.mjs","../../src/components/TopNavUtil.mjs","../../src/components/SettingsUtil.mjs","../../src/components/PlayersListUtil.mjs","../../src/components/LeftControlsUtil.mjs","../../src/components/Main.mjs","../../src/module.mjs"],"sourcesContent":["/**\n * Foundry Core hooks\n * https://foundryvtt.com/api/classes/client.Hooks.html\n * https://foundryvtt.com/api/modules/hookEvents.html\n * */ \nexport const HOOKS_CORE = {\n  INIT: \"init\", \n  READY: \"ready\", \n\n  /* Chat Messages */\n  RENDER_CHAT_MESSAGE: \"renderChatMessage\" ,\n\n  /* Left Side Controls */\n  GET_SCENE_CONTROLS: \"getSceneControlButtons\",\n  RENDER_SCENE_CONTROLS: \"renderSceneControls\",\n  RENDER_PLAYERS_LIST: \"renderPlayerList\",\n\n  /* Scene Navigation*/\n  RENDER_SCENE_NAV: \"renderSceneNavigation\",\n  COLLAPSE_SCENE_NAV: \"collapseSceneNavigation\",\n  EXPAND_SCENE_NAV: \"expandSceneNavigation\",\n\n  /* Right Side Panel */\n  COLLAPSE_SIDE_BAR: \"collapseSidebar\",\n\n  /* Macros */\n  RENDER_HOTBAR: \"renderHotbar\",\n\n  /* Camera Views */\n  RENDER_CAMERA_VIEWS: \"renderCameraViews\",\n\n  /* Update user */\n  UPDATE_USER: \"updateUser\",\n  UPDATE_DOCUMENT: \"updateDocument\"\n}","export const MODULE_ID = \"crlngn-ui\";\nexport const MODULE_TITLE = \"Carolingian UI\";\nexport const MODULE_SHORT = \"crlngn-ui\";\nexport const DEBUG_TAG = [\n  `%cCarolingian UI`,\n  `color:rgb(54, 0, 119); font-weight: bold;`,\n  `|`,\n];\n\nexport const ROLL_TYPES = {\n  abilityCheck: \"ability\",\n  abilitySave: \"save\",\n  attack: \"attack\",\n  check: \"check\",\n  concentration: \"concentration\",\n  damage: \"damage\",\n  deathSave: \"death\",\n  formula: \"formula\",\n  healing: \"heal\",\n  custom: \"roll\",\n  skillCheck: \"skill\",\n  toolCheck: \"tool\"\n}\n\nexport const CHAR_ABILITIES = [\n  { abbrev: \"str\", name: \"strength\" },\n  { abbrev: \"dex\", name: \"dexterity\" },\n  { abbrev: \"con\", name: \"constitution\" },\n  { abbrev: \"int\", name: \"intelligence\" },\n  { abbrev: \"wis\", name: \"wisdom\" },\n  { abbrev: \"cha\", name: \"charisma\" }\n]\n\nexport const CLASS_PREFIX = 'crlngn';","import { DEBUG_TAG } from \"../constants/General.mjs\";\n\nexport class LogUtil {\n  static debugOn = false;\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static log(ref=\"\", data=[], bypassSettings=false){\n    try{\n      const debugSetting = LogUtil.debugOn;\n      const isDebugModeOn = bypassSettings || debugSetting;\n      if(!isDebugModeOn){ return };\n\n      console.log(...DEBUG_TAG, ref, ...data);\n    }catch(e){\n      console.log(...DEBUG_TAG, ref, ...data);\n    }\n  }\n\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static warn(ref=\"\", data=[]){\n    console.warn(...DEBUG_TAG, ref, ...data);\n  }\n\n  /**\n   * Logs an error on the console and/or ui notification\n   * @param {string} strRef - Reference string for the error. \n   * @param {object} options - \n   */\n  static logError(strRef, options){ // = { ui:false, console:true, permanent:false }) {\n      if(options.ui){\n          // console.log(ui.notifications);\n          ui.notifications?.error(strRef, { localize: true, permanent: options.permanent });\n      }\n      if(options.console) console.error(...DEBUG_TAG, strRef);\n  }\n}\n\n","export const SETTING_INPUT = {\n  select: \"select\", \n  checkbox: \"checkbox\",\n  text: \"text\",\n  number: \"number\"\n}\n\nexport const SETTING_SCOPE = {\n  client: \"client\",\n  world: \"world\"\n}\n\nexport const ICON_SIZES = {\n  small: { name: 'small', size: '36px'},\n  regular: { name: 'regular', size: '42px'},\n}\n\nexport const BORDER_COLOR_TYPES = {\n  playerColor: { name: 'playerColor'},\n  rollType: { name: 'rollType'},\n  none: {\n    name: 'none'\n  }\n}\n\nexport const THEMES = [\n  {\n    label: 'Carolingian Teal',\n    className: '',\n    colorPreview: [\n      'rgb(62, 62, 88)',\n      'rgb(68, 147, 173)'\n    ]\n  },\n  {\n    label: \"Gold and Chocolate\",\n    className: 'crlngn-theme-gold-chocolate',\n    colorPreview: [\n      'rgb(34, 25, 25)',\n      'rgb(164, 138, 51)'\n    ]\n  },\n  {\n    label: \"Royal Blood\",\n    className: 'crlngn-theme-royal-blood',\n    colorPreview: [\n      'rgb(40, 31, 49)',\n      'rgb(127, 18, 36)'\n    ]\n  },\n  {\n    label: \"Dark Sorcery\",\n    className: 'crlngn-theme-dark-sorcery',\n    colorPreview: [\n      'rgb(31, 47, 49)',\n      'rgb(94, 57, 127)'\n    ]\n  },\n  {\n    label: \"Tangerine\",\n    className: 'crlngn-theme-tangerine',\n    colorPreview: [\n      'rgb(40, 31, 49)',\n      'rgb(220, 120, 43)'\n    ]\n  }\n];\n\nexport function getSettings() { \n  return {\n    customFontsMenu: {\n      tag: \"custom-font-families\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      description: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.description\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        'uiFontBody',\n        'uiFontTitles',\n        'journalFontBody',\n        'journalFontTitles'\n      ],\n      default: {\n        uiFontBody: `\"Work Sans\", Arial, sans-serif`,\n        uiFontTitles: `\"Roboto Slab\", Arial, sans-serif`,\n        journalFontBody: `\"Work Sans\", Arial, sans-serif`, \n        journalFontTitles: `\"Roboto Slab\", Arial, sans-serif`\n      },\n      scope: SETTING_SCOPE.world,\n      config: false, \n      requiresReload: false \n    },\n\n    themeAndStylesMenu: {\n      tag: \"theme-styles-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.label\"),\n      title: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.hint\"),\n      propType: String,\n      fields: [\n        \"colorTheme\", \n        \"adjustOtherModules\", \n        \"customStyles\" \n      ],\n      default: {\n        colorTheme: '',\n        adjustOtherModules: false,\n        customStyles: ''\n      },\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    chatMessagesMenu: {\n      tag: \"chat-messages-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        \"enableChatStyles\",\n        \"chatBorderColor\"\n      ],\n      default: { \n        enableChatStyles: true,\n        chatBorderColor: BORDER_COLOR_TYPES.playerColor.name\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    leftControlsMenu: {\n      tag: \"left-controls-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        \"controlsBottomBuffer\",\n        \"controlsIconSize\",\n        \"controlsAutoHide\",\n        \"hideFoundryLogo\"\n      ],\n      default: { \n        bottomBuffer: 200,\n        iconSize: ICON_SIZES.small.name,\n        autoHideSecondary: false,\n        hideFoundryLogo: true\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    cameraDockMenu: {\n      tag: \"camera-dock-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        enableFloatingDock: { \n          tag: \"enable-floating-camera-dock\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        dockPosX: {\n          tag: \"camera-dock-x\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockPosY: {\n          tag: \"camera-dock-y\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockWidth: {\n          tag: \"camera-dock-width\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockHeight: {\n          tag: \"camera-dock-height\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n      },\n      default: {\n        enableFloatingDock: true,\n        dockPosX: 0,\n        dockPosY: 120,\n        dockWidth: 140,\n        dockHeight: 140\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: false \n    },\n\n    sceneNavMenu: {\n      tag: \"scene-nav-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        sceneNavEnabled: { \n          tag: \"scene-nav-enabled\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        showNavOnHover: {\n          tag: \"show-nav-on-hover\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        }\n      },\n      default: {\n        sceneNavEnabled: true,\n        showNavOnHover: false\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: true \n    },\n\n    sceneNavCollapsed: { \n      tag: \"scene-nav-collapsed\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },  \n\n    sceneNavPos: { \n      tag: \"scene-nav-pos\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.hint\"), \n      propType: Number, \n      inputType: SETTING_INPUT.number, \n      default: 0, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    /*\n    enableChatStyles: { \n      tag: \"enable-chat-styles\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: true \n    },\n    */\n\n    enableMacroLayout: { \n      tag: \"enable-macro-layout\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    collapseMacroBar: { \n      tag: \"collapse-macro-bar\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    /* DARK MODE */\n    enforceDarkMode: { \n      tag: \"enforce-dark-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.world, \n      config: true \n    },  \n\n    autoHidePlayerList: { \n      tag: \"auto-hide-player-list\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    debugMode: { \n      tag: \"debug-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: false,\n      scope: SETTING_SCOPE.client,\n      config: true\n    },\n\n    /* NON-CONFIG SETTINGS */\n    /* FONTS */\n    uiFontBody: {\n      tag: \"ui-font-body\",\n      oldName: \"uiFont\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiBody.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiBody.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Work Sans\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n    uiFontTitles: {\n      tag: \"ui-font-titles\",\n      oldName: \"uiTitles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Roboto Slab\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n    journalFontBody: {\n      tag: \"journal-font-body\",\n      oldName: \"journalBody\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Work Sans\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    }, \n    journalFontTitles: {\n      tag: \"journal-font-titles\",\n      oldName: \"journalTitles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Roboto Slab\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    /* THEME AND STYLES */\n    colorTheme:{\n      tag: \"color-theme\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.colorTheme.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.colorTheme.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: \"\",\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    adjustOtherModules: {\n      tag: \"adjust-other-modules\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.adjustOtherModules.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.adjustOtherModules.hint\"),\n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: false,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    customStyles:{\n      tag: \"custom-styles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.customStyles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.customStyles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: \"\",\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    /* CHAT STYLES */\n    chatBorderColor: {\n      tag: \"chat-border-color\",\n      oldName: \"borderColor\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.hint\"),\n      options: {\n        playerColor: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.playerColor\"), \n        rollType: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.rollType\"), \n        none: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.none\")\n      }, \n      propType: String, \n      inputType: SETTING_INPUT.text, \n      default: BORDER_COLOR_TYPES.playerColor.name, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n    enableChatStyles:{\n      tag: \"enable-chat-styles\", \n      oldName: \"enableChatStyles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false,\n      requiresReload: true \n    },\n\n    /* CONTROLS SETTINGS */\n    controlsBottomBuffer:{\n      tag: \"control-bottom-buffer\",\n      oldName: \"bottomBuffer\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.hint\"),\n      propType: Number,\n      inputType: SETTING_INPUT.number,\n      default: 200,\n      scope: SETTING_SCOPE.client,\n      config: false\n    }, \n    controlsIconSize: {\n      tag: \"control-icon-size\",\n      oldName: \"iconSize\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.hint\"),\n      inputType: SETTING_INPUT.select, \n      options: {\n        small: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.small\"), \n        regular: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.regular\")\n      },\n      propType: String,\n      default: ICON_SIZES.small.name,\n      scope: SETTING_SCOPE.client,\n      config: false\n    },\n    controlsAutoHide: {\n      tag: \"auto-hide-secondary-controls\",\n      oldName: \"autoHideSecondary\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.hint\"), \n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: false,\n      scope: SETTING_SCOPE.client,\n      config: false\n    },\n    hideFoundryLogo: {\n      tag: \"hide-foundry-logo\",\n      oldName: \"hideFoundryLogo\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.hint\"), \n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: true,\n      scope: SETTING_SCOPE.client,\n      config: false\n    }\n\n  }\n\n}","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CameraDockSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    \n    return {\n      id: SETTINGS.cameraDockMenu.tag,\n      actions: {\n        redefine: CameraDockSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: CameraDockSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-camera\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/camera-dock-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    let controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    let isFloating = controlSettings.enableFloatingDock;\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    await SettingsUtil.set(SETTINGS.cameraDockMenu.tag, settings);\n    controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    LogUtil.log(\"Saving settings:\", [SETTINGS.cameraDockMenu.tag, form, formData.object, settings, controlSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if(controlSettings.enableFloatingDock != isFloating){\n      location.reload();\n    }\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.cameraDockMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.cameraDockMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.cameraDockMenu.tag),\n      default: {\n        ...SETTINGS.cameraDockMenu.default\n      },\n      fields: { ...SETTINGS.cameraDockMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class ChatMessagesSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.chatMessagesMenu.tag,\n      actions: {\n        redefine: ChatMessagesSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: ChatMessagesSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/chat-messages-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n    const currBorderSettings = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n    LogUtil.log(\"Compared settings:\", [ settings.chatBorderColor, currBorderSettings ]);\n    \n    fieldNames.forEach((fieldName) => {\n      LogUtil.log(\"Saving setting >>\", [SETTINGS[fieldName].tag, settings[fieldName]]);\n      if(settings[fieldName] !== undefined) {\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n    \n    // if(settings.enforceDarkMode === undefined){\n    //   delete settings.enforceDarkMode;\n    // }\n\n    await SettingsUtil.set(SETTINGS.chatMessagesMenu.tag, settings);\n    // await SettingsUtil.set(SETTINGS.enforceDarkMode.tag, settings.enforceDarkMode);\n\n    const borderSettings = settings.chatBorderColor;\n    if(borderSettings !== currBorderSettings){\n      location.reload();\n    }\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      LogUtil.log(\"_prepareContext\", [SETTINGS[fieldName].oldName]);\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    LogUtil.log(\"_prepareContext\", [fieldValues, fieldDefaults]);\n\n    const setting = {\n      ...fieldValues,\n      // enforceDarkMode: SettingsUtil.get(SETTINGS.enforceDarkMode.tag),\n      default: { ...fieldDefaults },\n      isGM: game.user.isGM,\n      fields: { ...fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", ChatMessagesSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { LogUtil } from \"./LogUtil.mjs\";\n\nexport class GeneralUtil {\n  /**\n   * Checks if module is currently installed and active\n   * @param {string} moduleName \n   * @returns \n   */\n  static isModuleOn(moduleName){\n    const module = game.modules?.get(moduleName);\n    // LogUtil.log(\"isModuleOn\", [module?.active]);\n    return module?.active ? true : false;\n  }\n\n  static html(parent, selector) {\n    return parent.querySelector(selector);\n  }\n\n  static getFullWidth(element) {\n    const style = window.getComputedStyle(element);\n    if (style.width === '0px') {\n      return 0;\n    }\n    return element.offsetWidth;\n  }\n\n  static getOffsetBottom(element) {\n    const offsetTop = element.offsetTop;\n    const elementHeight = element.offsetHeight;\n    const offsetParent = element.offsetParent;\n    const parentHeight = offsetParent ? offsetParent.clientHeight : window.innerHeight;\n  \n    return parentHeight - (offsetTop + elementHeight);\n  }\n\n\n  // Function to get a list with all the fonts available \n  // (Foundry + CSS imported) - excludes Font Awesome\n  static getAllFonts = async () => {\n    // Get Foundry built-in fonts\n    const foundryFonts = new Set(Object.keys(CONFIG.fontDefinitions));\n    // LogUtil.log('Foundry built-in fonts:', [Array.from(foundryFonts)]);\n    \n    // Get custom fonts from settings\n    const customFontsObj = game.settings.get(\"core\", \"fonts\") || {};\n    const customFonts = Object.entries(customFontsObj).map(([fontFamily]) => fontFamily);\n    // LogUtil.log('Custom fonts from settings:', [customFonts]);\n  \n    // Get CSS imported fonts\n    const cssImportedFonts = new Set();\n    \n    for (const sheet of document.styleSheets) {\n      try {\n        // Handle stylesheet text content for @import rules\n        if (sheet.ownerNode) {\n          let cssText = '';\n          \n          // Get text content from style tags\n          if (sheet.ownerNode.tagName === 'STYLE') {\n            cssText = sheet.ownerNode.textContent;\n          }\n          // Get text content from link tags\n          else if (sheet.ownerNode.tagName === 'LINK') {\n            try {\n              if (sheet.href?.startsWith(window.location.origin)) {\n                const rules = sheet.cssRules || sheet.rules;\n                cssText = Array.from(rules).map(rule => rule.cssText).join('\\n');\n              }\n            } catch (e) {\n              LogUtil.warn('Could not read stylesheet rules:', [e]);\n            }\n          }\n  \n          // Log the found CSS text for debugging\n          // LogUtil.log('Processing stylesheet text:', [cssText.slice(0, 200) + '...']);\n  \n          // Extract URLs from @import statements\n          const importUrlRegex = /@import\\s+url\\(['\"]([^'\"]+)['\"]\\)/g;\n          let match;\n          \n          while ((match = importUrlRegex.exec(cssText)) !== null) {\n            const url = match[1]; // This is the actual URL\n            // LogUtil.log('Found import URL:', [url]);\n  \n            if (url.includes('fonts.googleapis.com')) {\n              // Extract font family names from Google Fonts URL\n              const familyMatch = url.match(/family=([^&]+)/);\n              if (familyMatch) {\n                const families = decodeURIComponent(familyMatch[1])\n                  .split('|') // Split multiple families\n                  .map(family => {\n                    // Remove weight/style variations\n                    return family.split(':')[0].replace(/\\+/g, ' ');\n                  });\n                \n                families.forEach(family => {\n                  cssImportedFonts.add(family);\n                  // LogUtil.log('Added Google Font family:', [family]);\n                });\n              }\n            } else {\n              // For non-Google Fonts, try to fetch and parse the CSS\n              try {\n                const response = await fetch(url);\n                // response = response.text();\n                if (!response.ok) {\n                  if (response.status === 404) {\n                    LogUtil.warn('getAllFonts() - Resource not found (404)', [url]);\n                  } else {\n                    LogUtil.warn('getAllFonts() - HTTP error', [response.status]);\n                  }\n                }else{\n                  const fontFaceRules = css.match(/@font-face\\s*{[^}]+}/g) || [];\n                  fontFaceRules.forEach(rule => {\n                    const fontFamilyMatch = rule.match(/font-family:\\s*['\"]?([^'\";]+)['\"]?/);\n                    if (fontFamilyMatch) {\n                      const fontFamily = fontFamilyMatch[1].trim();\n                      cssImportedFonts.add(fontFamily);\n                      // LogUtil.log('Added font family from @font-face:', fontFamily);\n                    }\n                  });\n                }\n                \n\n                  // .then(response => response.text())\n                  // .then(css => {\n                  //   // Parse font-face rules\n                  //   const fontFaceRules = css.match(/@font-face\\s*{[^}]+}/g) || [];\n                  //   fontFaceRules.forEach(rule => {\n                  //     const fontFamilyMatch = rule.match(/font-family:\\s*['\"]?([^'\";]+)['\"]?/);\n                  //     if (fontFamilyMatch) {\n                  //       const fontFamily = fontFamilyMatch[1].trim();\n                  //       cssImportedFonts.add(fontFamily);\n                  //       // LogUtil.log('Added font family from @font-face:', fontFamily);\n                  //     }\n                  //   });\n                  // })\n                  // .catch(error => LogUtil.warn('Error loading imported CSS:', [error]));\n\n                \n              } catch (e) {\n                LogUtil.warn('Error processing imported CSS:', [e]);\n              }\n            }\n          }\n        }\n  \n        // Check for @font-face rules in the current stylesheet\n        if (!sheet.href || sheet.href.startsWith(window.location.origin)) {\n          try {\n            const rules = sheet.cssRules || sheet.rules;\n            for (const rule of rules) {\n              if (rule instanceof CSSFontFaceRule) {\n                const fontFamily = rule.style.getPropertyValue('font-family')\n                  .replace(/['\"`]/g, '')\n                  .trim();\n                cssImportedFonts.add(fontFamily);\n                // LogUtil.log('Found font-face rule for:', [fontFamily]);\n              }\n            }\n          } catch (e) {\n            LogUtil.warn('Could not read stylesheet rules:', [e]);\n          }\n        }\n      } catch (e) {\n        LogUtil.warn('Error processing stylesheet:', [e]);\n      }\n    }\n  \n    // Log what we found for debugging\n    LogUtil.log('Found fonts:', [{\n      foundry: Array.from(foundryFonts),\n      custom: customFonts,\n      cssImported: Array.from(cssImportedFonts)\n    }]);\n  \n    // Combine all fonts, filter, clean, sort\n    const allFonts = Array.from(new Set([\n      ...foundryFonts,\n      ...customFonts,\n      ...cssImportedFonts\n    ]))\n    .filter(f => !f.includes(\"FontAwesome\") && !f.includes(\"Font Awesome\") )\n    .map(f => f.replace(/['\"`]/g, '').trim())\n    .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));\n  \n    return allFonts;\n  }\n\n  // Helper function to format font names\n  static wrapFontName = (fontName) => {\n    const cleanName = fontName.replace(/['\"`]/g, '');\n    return cleanName.includes(' ') ? `\"${cleanName}\"` : cleanName;\n  };\n\n  static addLoggingToClass(Class) {\n    // For static methods (properties of the constructor)\n    const staticMethodNames = Object.getOwnPropertyNames(Class)\n      .filter(prop => typeof Class[prop] === 'function' && \n              prop !== 'constructor' && \n              prop !== 'prototype' &&\n              prop !== 'addLoggingToClass');\n    \n    console.log(`TEST: Adding logging to ${Class.name} static methods:`, staticMethodNames);\n    \n    staticMethodNames.forEach(methodName => {\n      const originalMethod = Class[methodName];\n      \n      Class[methodName] = function(...args) {\n        console.log(`TEST: Executing: ${Class.name}.${methodName}`);\n        return originalMethod.apply(this, args);\n      };\n    });\n    \n    // For instance methods (properties of the prototype)\n    const protoMethodNames = Object.getOwnPropertyNames(Class.prototype)\n      .filter(prop => typeof Class.prototype[prop] === 'function' && \n              prop !== 'constructor');\n    \n              console.log(`TEST: Adding logging to ${Class.name} prototype methods:`, protoMethodNames);\n    \n    protoMethodNames.forEach(methodName => {\n      const originalMethod = Class.prototype[methodName];\n      \n      Class.prototype[methodName] = function(...args) {\n        console.log(`TEST: Executing: ${Class.name}.${methodName}`);\n        return originalMethod.apply(this, args);\n      };\n    });\n  }\n\n  /**\n   * Adds css rules to a <style> element at the body\n   * @param {string} varName \n   * @param {string} varValue \n   */\n  static addCSSVars = (varName, varValue) => {\n    let bodyStyle = document.querySelector('#crlngn-ui-vars');\n    \n    if (!bodyStyle) {\n      // Create style element if it doesn't exist\n      const body = document.querySelector('body');\n      bodyStyle = document.createElement('style');\n      bodyStyle.id = 'crlngn-ui-vars';\n      bodyStyle.textContent = 'body.crlngn-ui {\\n}\\n';\n      body.prepend(bodyStyle);\n    }\n    \n    // Parse the current CSS content\n    let cssText = bodyStyle.textContent;\n    \n    // Find or create the rule block\n    let ruleStart = cssText.indexOf('body.crlngn-ui {');\n    let ruleEnd = cssText.indexOf('}', ruleStart);\n    \n    if (ruleStart === -1) {\n      // If rule doesn't exist, create it\n      cssText = 'body.crlngn-ui {\\n}\\n';\n      ruleStart = 0;\n      ruleEnd = cssText.indexOf('}');\n    }\n    \n    // Get all the current declarations\n    const rulePart = cssText.substring(ruleStart + 'body.crlngn-ui {'.length, ruleEnd);\n    \n    // Split by semicolons to get individual declarations\n    const declarations = rulePart.split(';')\n      .map(decl => decl.trim())\n      .filter(decl => decl !== '');\n    \n    // Create a map of existing variables\n    const varsMap = {};\n    declarations.forEach(decl => {\n      const parts = decl.split(':');\n      if (parts.length >= 2) {\n        const name = parts[0].trim();\n        const value = parts.slice(1).join(':').trim(); // Handle values that might contain colons\n        if (name) varsMap[name] = value;\n      }\n    });\n    \n    // Format the value if it appears to need quotes\n    // For string values used in content properties (i18n text)\n    if (varName.includes('i18n') && \n        typeof varValue === 'string' && \n        !varValue.startsWith('\"') && \n        !varValue.startsWith(\"'\") && \n        !varValue.match(/^url\\(|^rgba?\\(|^hsla?\\(/)) {\n      varValue = `\"${varValue}\"`;\n    }\n    \n    // Update or add the new variable\n    varsMap[varName] = varValue;\n    \n    // Rebuild the rule content\n    const newRuleContent = Object.entries(varsMap)\n      .map(([name, value]) => `  ${name}: ${value};`)\n      .join('\\n');\n    \n    // Rebuild the entire CSS\n    const newCss = \n      cssText.substring(0, ruleStart) + \n      'body.crlngn-ui {\\n' + \n      newRuleContent + \n      '\\n}' + \n      cssText.substring(ruleEnd + 1);\n    \n    // Update the style element\n    bodyStyle.textContent = newCss;\n  };\n\n  static addCustomCSS = (content) => {\n    let customStyle = document.querySelector('#crlngn-ui-custom-css');\n    \n    if (!customStyle) {\n      // Create style element if it doesn't exist\n      const body = document.querySelector('body');\n      customStyle = document.createElement('style');\n      customStyle.id = 'crlngn-ui-custom-css';\n      customStyle.textContent = 'body.crlngn-ui {\\n}\\n';\n      body.appendChild(customStyle);\n    }\n\n    customStyle.textContent = content;\n  }\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { GeneralUtil } from \"../GeneralUtil.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { Main } from \"../Main.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CustomFontsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static #element;\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.customFontsMenu.tag,\n      actions: {\n        redefine: CustomFontsSettings.#onReset,\n      },\n      form: {\n        handler: CustomFontsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-text\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n        // Add datalists to your content classes\n        contentClasses: [\"standard-form\", \"datalists\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/custom-fonts-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\");\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    SettingsUtil.set(SETTINGS.customFontsMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fontList: GeneralUtil.getAllFonts(),\n      fields: { \n        ...fields\n      },\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.save\" }\n      ]\n    }\n\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    // LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    CustomFontsSettings.#element = this.element;\n    \n    // Handle input focus and blur\n    const inputs = CustomFontsSettings.#element.querySelectorAll('input[type=\"text\"]');\n    inputs.forEach(input => {\n      const wrapper = input.closest('.dropdown-wrapper');\n      const dropdown = wrapper?.querySelector('.dropdown-options');\n      \n      if (!wrapper || !dropdown) return;\n  \n      // Show dropdown on input focus\n      const onFocus = () => {\n        CustomFontsSettings.#closeAllDropdowns();\n        dropdown.classList.add('active');\n      };\n      input.addEventListener('focus', onFocus);\n      input.addEventListener('click', onFocus);\n\n      // Add keyboard navigation\n      input.addEventListener('keydown', (e) => {\n        const isActive = dropdown.classList.contains('active');\n        const options = Array.from(dropdown.querySelectorAll('.dropdown-option'));\n        let currentIndex = options.findIndex(opt => opt.classList.contains('highlighted'));\n        \n        // Handle arrow down/up\n        if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n          e.preventDefault(); // Prevent cursor movement in input\n          \n          if (!isActive) {\n            dropdown.classList.add('active');\n          }\n          \n          // Remove current highlight\n          options.forEach(opt => opt.classList.remove('highlighted'));\n          \n          // Calculate new index\n          if (currentIndex === -1) {\n            currentIndex = e.key === 'ArrowDown' ? 0 : options.length - 1;\n          } else {\n            currentIndex = e.key === 'ArrowDown' \n              ? (currentIndex + 1) % options.length \n              : (currentIndex - 1 + options.length) % options.length;\n          }\n          \n          // Add highlight to new option and scroll into view\n          if (options[currentIndex]) {\n            options[currentIndex].classList.add('highlighted');\n            options[currentIndex].scrollIntoView({ block: 'nearest' });\n          }\n        }\n        \n        // Handle Enter key\n        else if (e.key === 'Enter') {\n          e.preventDefault();\n          \n          if (isActive && currentIndex !== -1 && options[currentIndex]) {\n            // Simulate click on the highlighted option\n            options[currentIndex].click();\n          }\n        }\n        \n        // Handle Escape key\n        else if (e.key === 'Escape') {\n          dropdown.classList.remove('active');\n        }\n      });\n\n      // Handle clicking outside\n      document.addEventListener('click', (e) => {\n        if (!wrapper.contains(e.target)) {\n          dropdown.classList.remove('active');\n        }\n      });\n    });\n  \n    // Handle option selection\n    const dropOptions = CustomFontsSettings.#element.querySelectorAll('.dropdown-option');\n    dropOptions.forEach(option => {\n      // Add mouse hover effect that syncs with keyboard highlighting\n      option.addEventListener('mouseenter', () => {\n        // Remove highlight from all options\n        const allOptions = option.closest('.dropdown-options').querySelectorAll('.dropdown-option');\n        allOptions.forEach(opt => opt.classList.remove('highlighted'));\n        \n        // Add highlight to current option\n        option.classList.add('highlighted');\n      });\n      \n      option.addEventListener('click', (e) => {\n        const input = option.closest('.dropdown-wrapper').querySelector('input');\n        // Get the value and handle potential quote escaping\n        let value = option.dataset.value;\n        \n        // If the value contains spaces but doesn't have quotes, add them\n        if (value.includes(' ') && !value.startsWith('\"')) {\n          value = `\"${value}\"`;\n        }\n        // If the value is already properly quoted, use it as is\n        else if (value.startsWith('&quot;')) {\n          value = value.replace(/&quot;/g, '\"');\n        }\n        \n        input.value = value;\n        const dropdown = option.closest('.dropdown-options');\n        dropdown.classList.remove('active');\n        \n        // Return focus to input after selection\n        // input.focus();\n      });\n    });\n  }\n  \n  static #closeAllDropdowns() {\n    CustomFontsSettings.#element.querySelectorAll('.dropdown-options').forEach(dropdown => {\n      dropdown.classList.remove('active');\n    });\n  }\n  \n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input[type=text]\");\n    // const menuValues = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n  \n\n}","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class LeftControlsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.leftControlsMenu.tag,\n      actions: {\n        redefine: LeftControlsSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: LeftControlsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/left-controls-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\");\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.leftControlsMenu.fields;\n    \n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.leftControlsMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.leftControlsMenu.default]);\n    // await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, SETTINGS.leftControlsMenu.default);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    const fieldNames = SETTINGS.leftControlsMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fields: { \n        ...fields\n      },\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", LeftControlsSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class SceneNavSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.sceneNavMenu.tag,\n      actions: {\n        redefine: SceneNavSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: SceneNavSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/scene-nav-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings(); \n    let menuSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag); \n    let navEnabled = menuSettings.sceneNavEnabled; \n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    await SettingsUtil.set(SETTINGS.sceneNavMenu.tag, settings);\n    menuSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n\n    LogUtil.log(\"Saving settings...\", [SETTINGS.sceneNavMenu.tag, form, formData.object, settings, menuSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if(menuSettings.sceneNavEnabled != navEnabled){\n      location.reload();\n    }\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.sceneNavMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.sceneNavMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.sceneNavMenu.tag),\n      default: {\n        ...SETTINGS.sceneNavMenu.default\n      },\n      fields: { ...SETTINGS.sceneNavMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","import { getSettings, THEMES } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class ThemeAndStyleSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static #element;\n\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.themeAndStylesMenu.tag,\n      actions: {\n        redefine: ThemeAndStyleSettings.#onReset,\n      },\n      form: {\n        handler: ThemeAndStyleSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 600,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-brush\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n        // Add datalists to your content classes\n        contentClasses: [\"standard-form\", \"datalists\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/theme-and-styles-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\");\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n    const selectedTheme = THEMES.find(theme => theme.label===settings.colorTheme);\n    settings.colorTheme = selectedTheme ? selectedTheme.className : '';\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    SettingsUtil.set(SETTINGS.themeAndStylesMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.themeAndStylesMenu.tag);\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const selectedTheme = THEMES.find(theme => {\n      return theme.className===fieldValues.colorTheme\n    });\n    fieldValues.colorTheme = selectedTheme?.label || THEMES[0].label;\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fields: { \n        ...fields\n      },\n      selectedTheme: selectedTheme,\n      themes: THEMES,\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.themeAndStylesMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.themeAndStylesMenu.save\" }\n      ]\n    }\n\n    // Store the initial context for later updates\n    this._initialContext = { ...fieldValues };\n\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    // LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    ThemeAndStyleSettings.#element = this.element;\n    \n    // Store reference to themes for later use\n    this._themes = THEMES;\n    \n    // Handle input focus and blur\n    const inputs = ThemeAndStyleSettings.#element.querySelectorAll('input[type=\"text\"]');\n    inputs.forEach(input => {\n      const wrapper = input.closest('.dropdown-wrapper');\n      const dropdown = wrapper?.querySelector('.dropdown-options');\n      \n      if (!wrapper || !dropdown) return;\n  \n      // Show dropdown on input focus\n      const onFocus = () => {\n        ThemeAndStyleSettings.#closeAllDropdowns();\n        dropdown.classList.add('active');\n      };\n      input.addEventListener('focus', onFocus);\n      input.addEventListener('click', onFocus);\n\n      // Add keyboard navigation\n      input.addEventListener('keydown', (e) => {\n        const isActive = dropdown.classList.contains('active');\n        const options = Array.from(dropdown.querySelectorAll('.dropdown-option'));\n        let currentIndex = options.findIndex(opt => opt.classList.contains('highlighted'));\n        \n        if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n          e.preventDefault();\n          \n          if (!isActive) {\n            dropdown.classList.add('active');\n          }\n          \n          // Remove current highlight\n          options.forEach(opt => opt.classList.remove('highlighted'));\n          \n          // Calculate new index\n          if (currentIndex === -1) {\n            currentIndex = e.key === 'ArrowDown' ? 0 : options.length - 1;\n          } else {\n            currentIndex = e.key === 'ArrowDown' \n              ? (currentIndex + 1) % options.length \n              : (currentIndex - 1 + options.length) % options.length;\n          }\n          \n          // Add highlight to new option and scroll into view\n          if (options[currentIndex]) {\n            options[currentIndex].classList.add('highlighted');\n            options[currentIndex].scrollIntoView({ block: 'nearest' });\n          }\n        }\n        \n        // Handle Enter key\n        else if (e.key === 'Enter') {\n          e.preventDefault();\n          \n          if (isActive && currentIndex !== -1 && options[currentIndex]) {\n            // Simulate click on the highlighted option\n            options[currentIndex].click();\n          }\n        }\n        \n        // Handle Escape key\n        else if (e.key === 'Escape') {\n          dropdown.classList.remove('active');\n        }\n      });\n\n      // Handle clicking outside\n      document.addEventListener('click', (e) => {\n        if (!wrapper.contains(e.target)) {\n          dropdown.classList.remove('active');\n        }\n      });\n    });\n  \n    // Handle option selection\n    const dropOptions = ThemeAndStyleSettings.#element.querySelectorAll('.dropdown-option');\n    const that = this; // Store reference to this for use in event handlers\n    \n    dropOptions.forEach(option => {\n      // Add mouse hover effect that syncs with keyboard highlighting\n      option.addEventListener('mouseenter', () => {\n        // Remove highlight from all options\n        const allOptions = option.closest('.dropdown-options').querySelectorAll('.dropdown-option');\n        allOptions.forEach(opt => opt.classList.remove('highlighted'));\n        \n        // Add highlight to current option\n        option.classList.add('highlighted');\n      });\n      \n      option.addEventListener('click', function(e) {\n        LogUtil.log('option', [option, option.querySelector('.theme-name')]);\n        const input = option.closest('.dropdown-wrapper').querySelector('input');\n        let value = option.querySelector('.theme-name').innerHTML.toString();\n        \n        // Update the input value\n        input.value = value;\n        \n        // Update the selectedTheme if this is the theme input\n        if (input.name === 'colorTheme') {\n          const selectedTheme = that._themes.find(theme => {\n            return theme.label === value;\n          });\n          \n          // Store the selected theme for form submission\n          that._selectedTheme = selectedTheme;\n          \n          // Update any UI elements that depend on selectedTheme\n          that._updateThemePreview(selectedTheme);\n        }\n        \n        const dropdown = option.closest('.dropdown-options');\n        dropdown.classList.remove('active');\n      });\n    });\n  }\n\n  /**\n   * Update any UI elements that depend on the theme selection\n   * @param {Object} theme - The selected theme object\n   * @private\n   */\n  _updateThemePreview(theme) {\n    // Implement any preview updates here\n    LogUtil.log(\"Selected theme updated:\", [theme]);\n    \n    if (!theme) return;\n    \n    const selectedThemeSpan = this.element.querySelectorAll('span.selected-theme');\n\n    selectedThemeSpan.forEach((span,i) => {\n      span.style.setProperty('background-color', theme.colorPreview[i]);\n    });\n  }\n  \n  static #closeAllDropdowns() {\n    ThemeAndStyleSettings.#element.querySelectorAll('.dropdown-options').forEach(dropdown => {\n      dropdown.classList.remove('active');\n    });\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input[type=text]\");\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const selectedTheme = THEMES.find(theme => theme.label===SETTINGS.colorTheme.default);\n    fieldDefaults.colorTheme = selectedTheme?.label || THEMES[0].label;\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n}","// import * as lang from '../lang/en.json';\nimport { CameraDockSettings } from '../components/settings-dialogs/CameraDockSettings.mjs';\nimport { ChatMessagesSettings } from '../components/settings-dialogs/ChatMessagesSettings.mjs';\nimport { CustomFontsSettings } from '../components/settings-dialogs/CustomFontSettings.mjs';\nimport { LeftControlsSettings } from '../components/settings-dialogs/LeftControlsSettings.mjs';\nimport { SceneNavSettings } from '../components/settings-dialogs/SceneNavSettings.mjs';\nimport { ThemeAndStyleSettings } from '../components/settings-dialogs/ThemeAndStylesSettings.mjs';\n// import * as lang from '../lang/en.json' assert { type: \"json\" };\n\nexport function getSettingMenus() {\n  return {\n    customFonts: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      icon: \"fas fa-text\",  \n      propType: CustomFontsSettings,\n      restricted: true \n    },\n    themeAndStylesMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: ThemeAndStyleSettings,\n      restricted: true \n    },\n    chatMessagesMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: ChatMessagesSettings,\n      restricted: false \n    },\n    leftControls: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: LeftControlsSettings,\n      restricted: false \n    },\n    cameraDockMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      icon: \"fas fa-camera\",  \n      propType: CameraDockSettings,\n      restricted: false \n    },\n    sceneNavMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      icon: \"fas fa-cog\",  \n      propType: SceneNavSettings,\n      restricted: false \n    }\n  };\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\nimport { Main } from \"./Main.mjs\"; \n\nexport class CameraUtil {\n  static #offsetX = 0;\n  static #offsetY = 0;\n  static isDragging = false;\n  static cameraContainer;\n  //resizing\n  static isResizing = false;\n  static #startX = 0;\n  static #startY = 0;\n  static #startWidth = 0;\n  static #startHeight = 0;\n  static #startBottom = 0;\n\n  static init(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(cameraSettings.enableFloatingDock){ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderFloating);\n      LogUtil.log(\"CameraUtil\", [cameraSettings]);\n      CameraUtil.onRenderFloating();\n    }else{ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderPlain);\n      CameraUtil.onRenderPlain();\n    } \n  }\n\n  static onRenderPlain(){\n    document.querySelector('#camera-views')?.classList.add('visible');\n  }\n\n  static onRenderFloating(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    document.querySelector('#camera-views')?.classList.add('crlngn-ui');\n    CameraUtil.cameraContainer = document.querySelector('#camera-views .camera-container');\n\n    const controlsElem = document.querySelector('#camera-views .user-controls');\n    const cameraGrid = document.querySelector('#camera-views .camera-grid');\n\n    LogUtil.log(\"CameraUtil.onRender\", [ cameraSettings.dockPosX, cameraSettings.dockPosY ]);\n\n    if(CameraUtil.cameraContainer && cameraGrid && controlsElem){\n      CameraUtil.cameraContainer?.insertBefore(controlsElem, cameraGrid);\n      document.querySelector('#camera-views .camera-container')?.classList.add('visible');\n    }\n    CameraUtil.makeDraggable();\n    CameraUtil.makeResizeable();\n    CameraUtil.resetPositionAndSize();\n    CameraUtil.placeControlsToggle();\n  }\n\n  static placeControlsToggle(){ \n    const camControls = document.querySelector('#camera-views .user-controls');\n    const existingButtons = camControls?.querySelectorAll(\".crlngn-video-toggle\");\n    LogUtil.log(\"placeControlsToggle\", [camControls, existingButtons]);\n\n    if(existingButtons?.length > 0){\n      return; \n    }\n\n    const controlBar = document.querySelector('#camera-views .user-controls .control-bar');\n    const btnToggle = document.createElement(\"button\"); \n    btnToggle.classList.add(\"crlngn-video-toggle\"); \n    btnToggle.innerHTML = '<i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i>';\n\n    camControls?.insertBefore(btnToggle, controlBar);\n  }\n\n  static makeDraggable(){\n    CameraUtil.cameraContainer?.addEventListener(\"mousedown\", (e) => {\n      const body = document.querySelector(\"body.crlngn-ui\");\n      \n      if(e.target.parentNode?.classList.contains('volume-bar')){\n        return;\n      }\n      body?.addEventListener(\"mousemove\", CameraUtil.#onDragMove);\n      body?.addEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n\n      const offsetBottom = GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer);\n      CameraUtil.isDragging = true;\n      CameraUtil.#offsetX = e.clientX - CameraUtil.cameraContainer?.offsetLeft;\n      CameraUtil.#offsetY = (window.innerHeight - e.clientY) - offsetBottom;\n      // CameraUtil.cameraContainer.style.zIndex = \"101\"; \n\n      e.stopPropagation();\n    }); \n\n  }\n\n  static makeResizeable(){\n    if(CameraUtil.cameraContainer){\n      const body = document.querySelector(\"body.crlngn-ui\");\n      const resizeHandle = document.createElement(\"div\");\n      resizeHandle.classList.add(\"resize-handle\");\n      CameraUtil.cameraContainer.append(resizeHandle);\n\n      resizeHandle.addEventListener(\"mousedown\", (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        CameraUtil.isResizing = true;\n    \n        CameraUtil.#startX = e.clientX;\n        CameraUtil.#startY = e.clientY;\n        CameraUtil.#startBottom = parseInt(getComputedStyle(CameraUtil.cameraContainer).bottom) || 0;\n        CameraUtil.#startWidth = CameraUtil.cameraContainer.offsetWidth;\n        CameraUtil.#startHeight = CameraUtil.cameraContainer.offsetHeight;\n    \n        body?.addEventListener(\"mousemove\", CameraUtil.#onResize);\n        body?.addEventListener(\"mouseup\", CameraUtil.#onStopResize);\n      });\n    }\n  }\n\n  static resetPositionAndSize({x, y, w, h} = { x: null, y: null, w: null, h: null }){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(!cameraSettings.enableFloatingDock || !CameraUtil.cameraContainer){ return }\n    if(!x && !y && !w && !h){\n      const savedPosX = cameraSettings.dockPosX || 0;\n      const savedPosY = cameraSettings.dockPosY || 0;\n      const savedWidth = cameraSettings.dockWidth || 0;\n      const savedHeight = cameraSettings.dockHeight || 0;\n\n      CameraUtil.cameraContainer.style.left = `${savedPosX}px`;\n      CameraUtil.cameraContainer.style.bottom = `${savedPosY}px`;\n      CameraUtil.cameraContainer.style.width = `${savedWidth}px`;\n      CameraUtil.cameraContainer.style.height = `${savedHeight}px`;\n    }else{\n      if(x){\n        CameraUtil.cameraContainer.style.left = `${x}px`;\n      }\n      if(y){\n        CameraUtil.cameraContainer.style.bottom = `${y}px`;\n      }\n      if(w){\n        CameraUtil.cameraContainer.style.width = `${w}px`;\n      }\n      if(h){\n        CameraUtil.cameraContainer.style.height = `${h}px`;\n      }\n    }\n    \n  }\n\n  // when user releases element\n  static #onDragRelease(e){\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    if(CameraUtil.isDragging){ \n      const body = document.querySelector(\"body.crlngn-ui\"); \n      cameraSettings.dockPosX = parseInt(CameraUtil.cameraContainer?.style.left) || 0; \n      cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom) || 0; \n\n      if(cameraSettings.dockPosY <= 0){ cameraSettings.dockPosY = 0 }\n      SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n      \n      body?.removeEventListener(\"mousemove\", CameraUtil.#onDragMove); \n      body?.removeEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n  \n      CameraUtil.isDragging = false; \n      e.stopPropagation(); \n    }\n    \n  } \n\n  // when user drags element\n  static #onDragMove(e){ \n    if (!CameraUtil.isDragging) return; \n    LogUtil.log(\"mousemove\", [ e.target.parentNode ]); \n    \n    if(CameraUtil.cameraContainer){\n      let left = e.clientX - CameraUtil.#offsetX;\n      let bottom = (window.innerHeight - e.clientY) -  CameraUtil.#offsetY;\n\n      if(left + CameraUtil.cameraContainer.offsetWidth > window.innerWidth){  \n        left = window.innerWidth - CameraUtil.cameraContainer.offsetWidt;\n      }\n      CameraUtil.cameraContainer.style.left = `${left}px`;\n\n      if(bottom + CameraUtil.cameraContainer.offsetHeight > window.innerHeight){  \n        bottom = window.innerHeight - CameraUtil.cameraContainer.offsetHeight;\n      } \n      CameraUtil.cameraContainer.style.bottom = `${bottom}px`;\n    }\n    // e.stopPropagation(); \n  } \n\n  // when user drags the resize handle\n  static #onResize(e) {\n    if (!CameraUtil.isResizing) return;\n    const newWidth = CameraUtil.#startWidth + (e.clientX - CameraUtil.#startX);\n    const deltaY = e.clientY - CameraUtil.#startY; // How much the mouse moved\n    const newHeight = CameraUtil.#startHeight + deltaY;\n    const newBottom = CameraUtil.#startBottom - deltaY;\n\n    CameraUtil.cameraContainer.style.width = `${newWidth}px`;\n    CameraUtil.cameraContainer.style.height = `${newHeight}px`;\n    CameraUtil.cameraContainer.style.bottom = `${newBottom}px`;\n  }\n\n  // when user releases the resize handle\n  static #onStopResize() {\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    const body = document.querySelector(\"body.crlngn-ui\");\n    CameraUtil.isResizing = false;\n    body?.removeEventListener(\"mousemove\", CameraUtil.#onResize);\n    body?.removeEventListener(\"mouseup\", CameraUtil.#onStopResize);\n\n    LogUtil.log(\"onStopResize\", [CameraUtil.cameraContainer?.style.width, CameraUtil.cameraContainer?.style.height, CameraUtil.cameraContainer?.style.bottom]);\n\n    cameraSettings.dockWidth = parseInt(CameraUtil.cameraContainer?.style.width || 0);\n    cameraSettings.dockHeight = parseInt(CameraUtil.cameraContainer?.style.height || 0);\n    cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom || 0);\n\n    SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n  }\n\n}","import { BORDER_COLOR_TYPES, getSettings } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class ChatUtil {\n  static chatBorderColor;\n  static enableChatStyles;\n\n  static init(){\n    const SETTINGS = getSettings();\n    ChatUtil.enableChatStyles = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n    ChatUtil.chatBorderColor = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n  }\n\n  static enrichCard = async(chatMessage, html) => {\n    LogUtil.log(\"renderChatMessage\", [ChatUtil.chatBorderColor, ChatUtil.enableChatStyles, BORDER_COLOR_TYPES.playerColor.name, chatMessage.author?.id]); \n    const rollType = chatMessage.flags?.dnd5e?.activity?.type || chatMessage.flags?.dnd5e?.roll?.type || \"custom\";\n    let chatItem = html.get ? html.get(0) : html;\n    chatItem.classList.add(rollType);\n\n    // Create a temporary div to parse the HTML content of message\n    const content = duplicate(chatMessage.content);\n    const tempElement = document.createElement('div');\n    tempElement.innerHTML = content;\n    LogUtil.log(\"enrichCard!!!\",[tempElement, tempElement?.firstChild, chatMessage.content, chatMessage]);\n\n    if(game.user.isGM && ChatUtil.enableChatStyles && (content!==\"\" && tempElement?.firstChild && tempElement.firstChild.classList.contains('crlngn'))){ \n      tempElement.firstChild.classList.add('crlngn');\n\n      const saveButtons = tempElement.querySelectorAll('.card-buttons button[data-action=rollSave]');\n      LogUtil.log(\"enrichCard\",[saveButtons.length]);\n      if (saveButtons.length > 0) {      \n        saveButtons.forEach(button => {\n          const visibleDCSpan = button.querySelector('.visible-dc');\n          const hiddenDCSpan = button.querySelector('.hidden-dc');\n          LogUtil.log(\"enrichCard\",[visibleDCSpan, hiddenDCSpan]);\n          visibleDCSpan.setAttribute('data-ability', button.getAttribute('data-ability') || \"\");\n          visibleDCSpan.setAttribute('data-dc', button.getAttribute('data-dc') || \"\");\n          hiddenDCSpan.setAttribute('data-ability', button.getAttribute('data-ability') || \"\");\n        });\n      }\n\n      // add border color\n      if(ChatUtil.chatBorderColor===BORDER_COLOR_TYPES.playerColor.name && chatMessage.author?.id){ \n        tempElement.firstChild.style.setProperty('border-color', `var(--user-color-${chatMessage.author.id})`);\n      }\n      // Update the message document with the modified content\n      await chatMessage.update({\n        content: tempElement.innerHTML\n      });\n    }else if(ChatUtil.chatBorderColor===BORDER_COLOR_TYPES.playerColor.name && chatMessage.author?.id){ \n      chatItem.style.setProperty('border-color', `var(--user-color-${chatMessage.author.id})`);\n    }\n\n    LogUtil.log(\"enrichCard\", [tempElement.firstChild]);\n\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nexport class ModuleCompatUtil {\n  static #checkPlayersTimeout;\n  static init(){\n\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, ModuleCompatUtil.checkPlayersList);\n    Hooks.on(HOOKS_CORE.RENDER_HOTBAR, ModuleCompatUtil.checkPlayersList);\n    // taskbar\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    if(isTaskbarOn){\n      Hooks.on(HOOKS_CORE.UPDATE_USER, ModuleCompatUtil.checkTaskbarLock);\n    }\n    ModuleCompatUtil.checkTaskbarLock();\n  }\n\n  static checkTaskbarLock = () => {\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    // const body = document.querySelector('body.crlngn-ui');\n    // const bodyStyle = document.querySelector('#crlngn-ui-vars');\n    const taskbarFlag = game.user.flags?.['foundry-taskbar'];\n    LogUtil.log(\"checkTaskbarLock\",[taskbarFlag]);\n\n    if(!isTaskbarOn || !taskbarFlag){\n      return;\n    }\n\n    const taskbarReduceSidebar = game.settings.get('foundry-taskbar','reduceSidebar');\n    if(taskbarFlag.taskbarSettings?.locked){\n      GeneralUtil.addCSSVars('--crlngn-sidebar-bottom', taskbarReduceSidebar ? '50px' : '0px');\n    }else{\n      GeneralUtil.addCSSVars('--crlngn-sidebar-bottom', '0px');\n    }\n\n    if(taskbarFlag.taskbarSettings?.locked){\n      GeneralUtil.addCSSVars('--crlngn-taskbar-height', '50px');\n    }else{\n      GeneralUtil.addCSSVars('--crlngn-taskbar-height', '10px');\n    }\n    const ftMoveStyle = document.querySelector(\"#ft-move-players-macro\");\n    if(ftMoveStyle){ftMoveStyle.innerHTML = '';}\n    ModuleCompatUtil.checkPlayersList();\n  }\n\n\n  static checkPlayersList = () => {\n    const body = document.querySelector('body');\n    const uiLeftPlayers = document.querySelector('#players');\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    const isPlayersDocked = isTaskbarOn ? game.settings.get('foundry-taskbar','dockPlayersList') : false;\n    const isMacroDocked = isTaskbarOn ? game.settings.get('foundry-taskbar','dockMacroBar') : false;\n    LogUtil.log('checkPlayersList',[isPlayersDocked, isTaskbarOn, isMacroDocked, game.settings]);\n    let timeoutDelay = 10;\n    \n    if(isPlayersDocked){\n      timeoutDelay = 250;\n    }\n    const hotbar = document.querySelector('#hotbar');\n    if(hotbar) hotbar.style.setProperty('visibility', 'hidden');\n    clearTimeout(ModuleCompatUtil.#checkPlayersTimeout);\n    ModuleCompatUtil.#checkPlayersTimeout =  setTimeout(()=>{\n      if(isPlayersDocked){\n\n        LogUtil.log('checkPlayersList TEST',[isPlayersDocked]);\n        body.classList.remove('with-players');\n        body.classList.remove('with-players-hide');\n        body.classList.add('players-hidden');\n      }else{\n        body.classList.remove('players-hidden');\n        if(body.querySelector('#players.auto-hide')){\n          body.classList.add('with-players-hide');\n          body.classList.remove('with-players');\n        }else if(uiLeftPlayers){\n          body.classList.add('with-players');\n          body.classList.remove('with-players-hide');\n        }\n      }\n      if(hotbar) hotbar.style.removeProperty('visibility');\n      clearTimeout(ModuleCompatUtil.#checkPlayersTimeout);\n    }, timeoutDelay);\n    \n    \n  }\n\n\n}","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nconst DEFAULT_FOLDER_ID = \"Favorites\";\n\nexport class SceneNavFolders {\n  static selectedFolder;\n  static folderList;\n  static folderData = [];\n\n  static init(){\n    if(!SceneNavFolders.folderData || SceneNavFolders.folderData.length === 0){\n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      if(!isMonksScenenNavOn){\n        SceneNavFolders.preloadTemplate();\n      }\n      LogUtil.log(\"SceneNavFolders\",[ui.scenes]);\n      SceneNavFolders.folderData = SceneNavFolders.getFolders(ui.scenes.folders);\n      SceneNavFolders.selectedFolder = SceneNavFolders.selectFolder(\"KkaCkFDLOFGHmVAF\"); // (\"j6VwZl4dQMz4mqmX\");\n    }\n    SceneNavFolders.registerHooks();\n  }\n\n  /**\n   * \n   * @param {object[]} fromList \n   * @returns \n   */\n  static getFolders = (fromList) => {\n    let folders = fromList.filter(f => { \n      return f.folder === null;\n    });\n\n    // alphabetical order\n    folders.sort((a, b) => {\n      return a.name.toLowerCase().localeCompare(b.name.toLowerCase())\n    });\n    LogUtil.log(\"getFolders\", [folders]);\n\n    return folders;\n  }\n\n  static selectFolder = (id) => {\n    return SceneNavFolders.getFolderById(id) || null;\n  }\n\n  /**\n   * \n   * @param {string} id - Scene folder id\n   */\n  static getFolderById(id){\n    return ui.scenes.folders.find(fd => {\n      return fd.id===id\n    }) || DEFAULT_FOLDER_ID;\n  }\n\n  static createFolderElem = () => {\n    const folderElem = document.createElement(\"li\");\n    return folderElem;\n  }\n\n  static createListElement = (folders) => {\n    const folderList = document.createElement(\"ol\"); \n    folderList.classList.add('folder-list');\n\n    folders.forEach(f => {\n      const folder = document.createElement(\"li\");\n\n      LogUtil.log(\"createListElement\", [f]);\n      \n      if(f.children && f.children.length > 0){\n        folder.innerHTML = `<a class=\"with-subfolders\">${f.name}</a>`; \n      }else{\n        folder.innerHTML = `<a>${f.name}</a>`; \n      }\n      folderList.append(folder);\n    })\n\n    return folderList;\n  }\n\n  static preloadTemplate = async() => {\n    const templatePath = [\n      `modules/${MODULE_ID}/templates/scene-folder-list.hbs`\n    ];\n    \n    // This returns an object with paths as keys and template functions as values\n    await loadTemplates(templatePath);\n\n    LogUtil.log(\"preloadTemplate\", [true]);\n  \n    return true;\n  }\n\n  static getFoldersData = (folder) => {\n    return {\n      ...folder,\n      children: folder.children.map(fc => SceneNavFolders.getFoldersData(fc)),\n      hasSubfolders: folder.children.length > 0,\n      id: folder.id\n    };\n  }\n\n  static renderSceneFolders = async() => {\n    let folderElement, templateData;\n\n    if(!SceneNavFolders.selectedFolder){return;}\n    LogUtil.log(\"SCENE NAV renderSceneFolders\", []);\n\n    folderElement = document.querySelector('#crlngn-scene-folders');\n    if(folderElement){\n      folderElement.remove();\n    }\n    const folders = SceneNavFolders.getFolders(ui.scenes.folders);\n\n    if(SceneNavFolders.selectedFolder === DEFAULT_FOLDER_ID){\n      // Prepare data for template\n      templateData = {\n        favoritesId: DEFAULT_FOLDER_ID,\n        folderList: folders.map(f => SceneNavFolders.getFoldersData(f) ),\n        currFolder: { name: DEFAULT_FOLDER_ID },\n        currIcon: 'fa-star',\n        scenes: ui.nav.scenes,\n        users: game.users.contents,\n        isGM: game.user.isGM\n      };\n    }else{\n      templateData = {\n        favoritesId: DEFAULT_FOLDER_ID,\n        folderList: folders.map(f => SceneNavFolders.getFoldersData(f) ),\n        currFolder: SceneNavFolders.selectedFolder,\n        currIcon: 'fa-folder',\n        scenes: SceneNavFolders.selectedFolder.contents,\n        users: game.users.contents,\n        isGM: game.user.isGM\n      };\n    }\n    \n    LogUtil.log(\"SCENE NAV templateData\", [templateData]);\n\n    // Render the template using renderTemplate\n    const renderedHtml = await renderTemplate(`modules/${MODULE_ID}/templates/scene-folder-list.hbs`, templateData);\n    \n    // Find the DOM element before which you want to insert your content\n    const targetElement = document.querySelector('#scene-list');\n    \n    // Insert the HTML content before the target element\n    targetElement.insertAdjacentHTML('beforebegin', renderedHtml);\n    folderElement = document.querySelector('#crlngn-scene-folders');\n\n    folderElement.classList.remove('hidden');\n    targetElement.classList.add('hidden');\n    // if(SceneNavFolders.selectedFolder){\n    //   folderElement.classList.remove('hidden');\n    //   targetElement.classList.add('hidden');\n    // }else{\n    //   folderElement.classList.add('hidden');\n    //   targetElement.classList.remove('hidden');\n    // }\n    const insertedHtml = targetElement.previousElementSibling;\n    SceneNavFolders.activateListeners(insertedHtml);\n  }\n\n  static activateListeners = (html) => {\n    // Add click event to all toggle spans\n    html.querySelectorAll('span.toggle').forEach(toggleSpan => {\n      toggleSpan.addEventListener('click', (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        // Find the parent li\n        const parentLi = event.currentTarget.closest('li');\n        // Find the subfolders list within this li\n        const subfoldersOl = parentLi.querySelector('ol.subfolders');\n        \n        // Toggle visibility of the subfolders\n        if (!subfoldersOl) { return }\n        const isHidden = !(subfoldersOl.classList.contains('open'));\n        if(isHidden){\n          subfoldersOl.classList.add('open');\n          event.currentTarget.textContent = '';\n        }else{\n          subfoldersOl.classList.remove('open');\n          event.currentTarget.textContent = '+';\n        }\n      });\n    });\n\n    const folderItems = html.querySelectorAll(\".folder-list li.folder\");\n    folderItems.forEach(fi => {\n      fi.addEventListener(\"click\", SceneNavFolders.onSelectFolder);\n    })\n  }\n\n  static onSelectFolder = (evt) => {\n    evt.stopPropagation();\n    evt.preventDefault();\n    const target = evt.currentTarget;\n    const data = target.dataset;\n    LogUtil.log(\"onSelectFolder\", [target, data, data.folderId]);\n    SceneNavFolders.selectedFolder = SceneNavFolders.selectFolder(data.folderId || \"\");\n    SceneNavFolders.refreshFolderView()\n    // SceneNavFolders.renderSceneFolders();\n  }\n\n  static refreshFolderView() {\n    // Update the folder data\n    SceneNavFolders.folderData = SceneNavFolders.getFolders(ui.scenes.folders);\n    // Re-render the scene folders\n    SceneNavFolders.renderSceneFolders();\n  }\n\n  static registerHooks() {\n    Hooks.on(\"createFolder\", (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    Hooks.on(\"updateFolder\", (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    Hooks.on(\"deleteFolder\", (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    // Also hook into scene changes\n    Hooks.on(\"createScene\", () => SceneNavFolders.refreshFolderView());\n    Hooks.on(\"updateScene\", () => SceneNavFolders.refreshFolderView());\n    Hooks.on(\"deleteScene\", () => SceneNavFolders.refreshFolderView());\n  }\n\n}","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SceneNavFolders } from \"./SceneFoldersUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class TopNavigation {\n  static #navElem;\n  static #scenesList;\n  static #navTimeout;\n  static #navExtras;\n  static #navToggle;\n  static #uiMiddle;\n  static SETTINGS;\n  static navSettings;\n  static isCollapsed;\n  static navPos;\n  static sceneFoldersTemplate;\n  static #timeout;\n  static #collapseTimeout;\n\n  static init = async() => {\n    const SETTINGS = getSettings();\n    TopNavigation.navSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n    TopNavigation.isCollapsed = SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag);\n    TopNavigation.navPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n\n    TopNavigation.resetLocalVars();\n    // if user disabled Scene Navigation Styles,\n    // skip everything\n    const uiMiddle = document.querySelector(\"#ui-middle\");\n    let navSettings = TopNavigation.navSettings;\n    LogUtil.log(\"SCENE NAV INIT\", [navSettings.sceneNavEnabled]);\n    if(navSettings.sceneNavEnabled && uiMiddle){\n      uiMiddle.classList.add(\"crlngn-ui\");\n    }else if(uiMiddle){\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      return;\n    }\n\n    \n\n    // If Monk's Scene Navigation is enabled, disable Carolingian UI Top Navigation\n    const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n    if(isMonksScenenNavOn && navSettings.sceneNavEnabled){\n      // &.navigation-collapsed, &.with-monks-scene\n      if(game.user.isGM){\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksScenesNotSupported\"), {permanent: true});\n      }\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      SettingsUtil.set(SETTINGS.sceneNavMenu.tag, {\n        ...navSettings,\n        sceneNavEnabled: false\n      });\n    }\n    \n    LogUtil.log(\"TopNavigation - init\", [ isMonksScenenNavOn ]);\n\n    if(!isMonksScenenNavOn){\n      TopNavigation.resetLocalVars();\n      SceneNavFolders.renderSceneFolders();\n      \n      TopNavigation.setNavPosition();\n      TopNavigation.placeNavButtons(); \n      TopNavigation.toggleNav(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag));\n    }else{\n      uiMiddle.classList.add('with-monks-scene');\n    }\n    // LogUtil.log(\"RENDER_NAV\", [ui.nav, game]);\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, (a, b, c, d) => { \n      LogUtil.log(\"SCENE NAV\", [a, b, c, d]);\n      const SETTINGS = getSettings();\n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ isMonksScenenNavOn ]);\n      \n      if(!isMonksScenenNavOn){\n        LogUtil.log(\"NAV no transition add\");\n        TopNavigation.navPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n\n\n        SceneNavFolders.init();\n        TopNavigation.resetLocalVars();\n        SceneNavFolders.renderSceneFolders();\n        if(this.#scenesList) this.#scenesList.classList.add(\"no-transition\");\n        LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, []); \n        \n        TopNavigation.placeNavButtons();\n        TopNavigation.addListeners();\n        // TopNavigation.observeNavOffset();\n        TopNavigation.setNavPosition();\n        TopNavigation.toggleNav(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag));\n        //\n        clearTimeout(TopNavigation.#timeout);\n        TopNavigation.#timeout = setTimeout(()=>{\n          if(this.#scenesList) this.#scenesList.classList.remove(\"no-transition\");\n          LogUtil.log(\"NAV no transition remove\");\n        }, 500);\n      }\n\n      LogUtil.log(\"SCENE NAV STATE\", [SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)]);\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SIDE_BAR, (value) => { \n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.COLLAPSE_SIDE_BAR, [\"isMonksScenenNavOn\",isMonksScenenNavOn]);\n      if(!isMonksScenenNavOn){\n        TopNavigation.placeNavButtons(); \n      }\n      \n      \n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SCENE_NAV, (nav, collapsed) => {\n      const SETTINGS = getSettings();\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, collapsed); \n      LogUtil.log(\"NAV toggle\", [nav, collapsed]); \n\n\n      TopNavigation.isCollapsed = collapsed;\n      // const uiMiddle = document.querySelector(\"#ui-middle\");\n\n      TopNavigation.toggleNav(collapsed);\n    }); \n\n    Hooks.on(HOOKS_CORE.EXPAND_SCENE_NAV, (nav, value) => {\n      // const SETTINGS = getSettings();\n      LogUtil.log(\"NAV expand\", [nav, false]); \n      // SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, false); \n      // TopNavigation.isCollapsed = false;\n    }); \n\n    // SettingsUtil.apply(SETTINGS.sceneNavCollapsed.tag); \n    window.addEventListener('resize', ()=>{\n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      if(!isMonksScenenNavOn){\n        TopNavigation.placeNavButtons();\n      }\n    });\n\n    LogUtil.log(\"TopNavigation - init\", [navSettings.sceneNavEnabled])\n    \n    // if(navSettings.sceneNavEnabled){ \n    //   // TopNavigation.observeNavOffset(); \n    // } \n\n  } \n\n  static toggleNav(collapsed){\n    clearTimeout(TopNavigation.#collapseTimeout);\n    TopNavigation.#collapseTimeout = setTimeout(()=>{\n      TopNavigation.resetLocalVars();\n      if(collapsed){\n        ui.nav.collapse();\n        TopNavigation.#uiMiddle.classList.add('navigation-collapsed');\n      }else{\n        ui.nav.expand();\n        TopNavigation.#uiMiddle.classList.remove('navigation-collapsed');\n      }\n    }, 500);\n    \n  }\n\n  static resetLocalVars(){\n    TopNavigation.#navElem = document.querySelector(\"#navigation\"); \n    TopNavigation.#scenesList = document.querySelector(\"#scene-list\"); \n    TopNavigation.#navExtras = document.querySelector(\"#navigation .nav-item.is-root\"); \n    TopNavigation.#navToggle = document.querySelector(\"#nav-toggle\"); \n    TopNavigation.#uiMiddle = document.querySelector(\"#ui-middle\");\n    // TopNavigation.#leftControls = document.querySelector(\"#ui-left #controls\"); \n  }\n\n  static addListeners(){\n    TopNavigation.#navElem?.addEventListener(\"mouseenter\", ()=>{\n      LogUtil.log(\"TopNavigation mouseenter\", [ ]);\n    \n      if( !TopNavigation.isCollapsed ||\n          !TopNavigation.navSettings?.showNavOnHover ){ \n            return;\n      }\n      clearTimeout(this.#navTimeout);\n\n      const list = document.querySelector(\"#scene-list\");\n      if(list) {list.style.display = \"flex\";}\n      const navigation = document.querySelector(\"#navigation\");\n      navigation.classList.remove(\"collapsed\");\n    });\n\n    this.#navElem?.addEventListener(\"mouseleave\", (e)=>{\n      LogUtil.log(\"TopNavigation mouseleave\", [ ]);\n      if( !TopNavigation.isCollapsed ||\n          !TopNavigation.navSettings?.showNavOnHover ){ \n          return;\n      }\n      if (!e) var e = window.event;\n      e.cancelBubble = true;\n      if (e.stopPropagation) e.stopPropagation();\n\n      this.#navTimeout = setTimeout(()=>{\n        clearTimeout(this.#navTimeout);\n        this.#navTimeout = null;\n        const list = document.querySelector(\"#scene-list\");\n        if(list) {list.style.display = \"none\";}\n        const navigation = document.querySelector(\"#navigation\");\n        navigation.classList.add(\"collapsed\");\n      }, 700);\n    });\n  }\n\n  static placeNavButtons(){ \n    TopNavigation.resetLocalVars();\n\n    const existingButtons = this.#navElem?.querySelectorAll(\"button.crlngn-nav\");\n    const isNavOverflowing = this.#scenesList?.scrollWidth >= this.#navElem?.offsetWidth;\n    LogUtil.log(\"placeNavButtons\", [ isNavOverflowing, existingButtons, this.#scenesList?.scrollWidth, this.#navElem?.offsetWidth]);\n    \n    if(!isNavOverflowing || existingButtons.length > 0){\n      return;\n    }\n\n    const btnLast = document.createElement(\"button\"); \n    btnLast.classList.add(\"crlngn-nav\"); \n    btnLast.classList.add(\"ui-nav-left\"); \n    const arrowLeft = document.createElement(\"i\"); \n    arrowLeft.classList.add(\"fa\"); \n    arrowLeft.classList.add(\"fa-chevron-left\"); \n    btnLast.addEventListener(\"click\", this.#onNavLast);\n    btnLast.append(arrowLeft); \n\n    const btnNext = document.createElement(\"button\"); \n    btnNext.classList.add(\"crlngn-nav\"); \n    btnNext.classList.add(\"ui-nav-right\"); \n    const arrowRight = document.createElement(\"i\"); \n    arrowRight.classList.add(\"fa\"); \n    arrowRight.classList.add(\"fa-chevron-right\"); \n    btnNext.append(arrowRight); \n    btnNext.addEventListener(\"click\", this.#onNavNext);\n\n    this.#navElem?.appendChild(btnLast);\n    this.#navElem?.appendChild(btnNext);\n  }\n\n\n  static #onNavLast = (e) => {\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = TopNavigation.navPos || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos - itemsPerPage;\n    newPos = newPos < 0 ? 0 : newPos;\n\n    LogUtil.log(\"onNavLast\", [\"sceneCount\", scenes.length, currPos, newPos]);\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  static #onNavNext = (e) => {\n    // const SETTINGS = getSettings();\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = TopNavigation.navPos || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos + itemsPerPage;\n    newPos = newPos > scenes.length ? scenes.length : newPos;\n\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  static setNavPosition(pos) { \n    const SETTINGS = getSettings();\n    if(!this.#scenesList){ return; }\n    const position = pos !== undefined ? pos : TopNavigation.navPos || 0;\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n\n    \n    const newMargin = scenes[position]?.offsetLeft * -1;\n    this.#scenesList.style.marginLeft = newMargin + 'px';\n\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, position);\n\n    LogUtil.log(\"setNavPosition\", [pos, position, scenes[position], newMargin]);\n  }\n\n  \n  \n}\n\n/*\ngetData(options={}) {\n  let favLabel = game.i18n.localize(\"CRLNGN_UI.settings.sceneGroupsNav.folderFavorites\");\n  let favGroup = { \n    id: 'crlngn-scene-groups-favorites', \n    active: true, \n    name: favLabel, \n    icon: \"fa-star\", \n    tooltip: game.user.isGM ? favLabel : null, \n    users: [], \n    visible: true, \n    css: \"gm active\" \n  }; \n\n  let folders = [];\n  folders = ui.scenes.folders.filter(f => { \n    return f.folder === null; // true;\n  });\n\n  folders.sort((a, b) => {\n    return a.name.toLowerCase().localeCompare(b.name.toLowerCase())\n  });\n\n  let folderList = folders.map(folder => {\n    return {\n      id: folder.id,\n      active: true,\n      name: folder.name,\n      icon: \"fa-folder\",\n      tooltip: folder.name,\n      users: [],\n      visible: game.user.isGM || folder.isOwner,\n      css: \"gm\"\n    };\n  });\n  folderList = [favGroup, ...folderList];\n\n  LogUtil.log(\"SceneGroupsNavigation\", [folders]);\n  let sceneList = this.scenes.map(scene => {\n    return {\n      id: scene.id,\n      active: scene.active,\n      name: TextEditor.truncateText(scene.navName || scene.name, {maxLength: 32}),\n      tooltip: scene.navName && game.user.isGM ? scene.name : null,\n      users: game.users.reduce((arr, u) => {\n        if ( u.active && ( u.viewedScene === scene.id) ) arr.push({letter: u.name[0], color: u.color.css});\n        return arr;\n      }, []),\n      visible: game.user.isGM || scene.isOwner || scene.active,\n      css: [\n        scene.isView ? \"view\" : null,\n        scene.active ? \"active\" : null,\n        scene.ownership.default === 0 ? \"gm\" : null\n      ].filterJoin(\" \")\n    };\n  });\n  return {collapsed: this._collapsed, scenes: sceneList, folders: folderList};\n}*/","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettingMenus } from \"../constants/SettingMenus.mjs\";\nimport { BORDER_COLOR_TYPES, getSettings, ICON_SIZES, THEMES } from \"../constants/Settings.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { ModuleCompatUtil } from \"./ModuleCompatUtil.mjs\";\nimport { TopNavigation } from \"./TopNavUtil.mjs\";\n\nexport class SettingsUtil {\n  static #uiHidden = false;\n  static firstLoad = true;\n  /**\n   * Registers settings for this module\n   */\n  static registerSettings(){\n    const SETTINGS = getSettings();\n    LogUtil.log(\"registerSettings - test\", [SETTINGS], true);\n    document.querySelector(\"body\").classList.add(MODULE_ID); \n    \n    /**\n     * Register each of the settings defined in the SETTINGS constant \n     */\n    \n    const settingsList = Object.entries(SETTINGS);\n    settingsList.forEach(async(entry) => {\n      const setting = entry[1]; \n      LogUtil.log(\"Registering... \",[entry], true);\n\n      const settingObj = { \n        name: setting.label,\n        hint: setting.hint,\n        default: setting.default,\n        type: setting.propType,\n        scope: setting.scope,\n        config: setting.config,\n        requiresReload: setting.requiresReload || false,\n        onChange: value => SettingsUtil.apply(setting.tag, value)\n      }\n\n      if(setting.choices){\n        settingObj.choices = setting.choices\n      }\n\n      await game.settings.register(MODULE_ID, setting.tag, settingObj);\n\n      if(SettingsUtil.get(setting.tag)===undefined){\n        SettingsUtil.set(setting.tag, setting.default);\n      }\n\n      game.keybindings.register(MODULE_ID, \"hideInterface\", {\n        name: \"Toggle Hide/Show User Interface\",\n        hint: \"Hides or shows the UI. This will affect all elements inside the `#interface` html block\",\n        // uneditable: [\n        //   {\n        //     key: \"Digit1\",\n        //     modifiers: [\"Control\"]\n        //   }\n        // ],\n        editable: [\n          {\n            key: \"0\",\n            modifiers: [\"Control\"]\n          }\n        ],\n        onDown: () => {  },\n        onUp: () => { SettingsUtil.hideInterface() },\n        restricted: false,             // Restrict this Keybinding to gamemaster only?\n        // reservedModifiers: [\"Alt\"],  // On ALT, the notification is permanent instead of temporary\n        // precedence: CONST.KEYBINDING_PRECEDENCE.NORMAL\n      });\n\n      // LogUtil.log(\"registerSettings\",[setting.tag, SettingsUtil.get(setting.tag)]);\n    });\n\n    // Apply custom theme and CSS\n    SettingsUtil.applyThemeSettings();\n    SettingsUtil.applyCustomCSS();\n    SettingsUtil.applyModuleAdjustments();\n\n    /**\n     * Register subsetting menus\n     */\n    const settingMenus = Object.entries(getSettingMenus());\n    settingMenus.forEach(async(entry) => {\n      const settingMenu = entry[1]; \n      const settingMenuObj = {\n        name: settingMenu.tag,\n        label: settingMenu.label, \n        hint: settingMenu.hint,\n        icon: settingMenu.icon, \n        type: settingMenu.propType,\n        restricted: settingMenu.restricted\n      }\n      await game.settings.registerMenu(MODULE_ID, settingMenu.tag, settingMenuObj); \n    });\n\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, SettingsUtil.applyLeftControlsSettings);\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, SettingsUtil.applyPlayersListSettings); \n    Hooks.on(HOOKS_CORE.RENDER_HOTBAR, () => {\n      if(SettingsUtil.firstLoad){\n        SettingsUtil.firstLoad = false;\n        SettingsUtil.applyHotBarCollapse();\n      }\n      SettingsUtil.applyHotBarSettings();\n    });\n    //apply debug Settings\n    SettingsUtil.applyDebugSettings();\n    //\n    SettingsUtil.applySceneNavPos();\n    // apply chat style settings\n    SettingsUtil.applyChatStyles();\n    // aply border colors\n    SettingsUtil.applyBorderColors();\n\n    // apply custom font settings\n    const fontFields = SETTINGS.customFontsMenu.fields;\n    fontFields.forEach(fieldName => {\n      SettingsUtil.applyCustomFonts(SETTINGS[fieldName].tag);\n    });   \n\n    // apply left controls settings\n    const controlFields = SETTINGS.leftControlsMenu.fields;\n    controlFields.forEach(fieldName => {\n      SettingsUtil.applyLeftControlsSettings(SETTINGS[fieldName].tag);\n    }); \n\n\n\n  }\n\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  static get(settingName, moduleName=MODULE_ID){\n    if(!settingName){ return null; }\n\n    let setting = false;\n\n    if(moduleName===MODULE_ID){\n      setting = game.settings.get(moduleName, settingName);\n    }else{\n      const client = game.settings.storage.get(\"client\");\n      let selectedSetting = client[`${moduleName}.${settingName}`];\n      //\n      if(selectedSetting===undefined){\n        const world = game.settings.storage.get(\"world\");\n        selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n      }\n      setting = selectedSetting?.value;\n      LogUtil.log(\"GET Setting\", [selectedSetting, setting]);\n    }\n\n    return setting;\n  }\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  static set(settingName, newValue, moduleName=MODULE_ID){ \n    if(!settingName){ return false; }\n\n    let selectedSetting = game.settings.storage.get(\"client\")[`${moduleName}.${settingName}`];\n\n    if(!selectedSetting){\n      const world = game.settings.storage.get(\"world\");\n      selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n    } \n    LogUtil.log(\"Setting\",[settingName, selectedSetting]);\n\n    try{\n      game.settings.set(moduleName, settingName, newValue);\n      // selectedSetting.update({value: newValue});\n    }catch(e){\n      LogUtil.log(\"Unable to change setting\",[settingName, selectedSetting]);\n    }\n\n    return true;\n  }\n\n  /**\n   * Apply current settings\n   */\n  static apply(settingTag, value=undefined){\n    const SETTINGS = getSettings();\n\n    if(value===undefined){\n      value = SettingsUtil.get(settingTag);\n    }\n    LogUtil.log(\"SettingsUtil.apply\",[settingTag, value, SettingsUtil.get(settingTag)]); \n    switch(settingTag){\n      case SETTINGS.enableMacroLayout.tag:\n        SettingsUtil.applyHotBarSettings();\n        break;\n      case SETTINGS.collapseMacroBar.tag:\n        SettingsUtil.applyHotBarCollapse();\n        break;\n      case SETTINGS.autoHidePlayerList.tag:\n        SettingsUtil.applyPlayersListSettings();\n        break;\n      case SETTINGS.uiFontBody.tag:\n      case SETTINGS.uiFontTitles.tag:\n      case SETTINGS.journalFontBody.tag:\n      case SETTINGS.journalFontTitles.tag:\n        SettingsUtil.applyCustomFonts(settingTag, value);\n        break;\n      case SETTINGS.controlsBottomBuffer.tag:\n      case SETTINGS.controlsIconSize.tag:\n      case SETTINGS.controlsAutoHide.tag:\n      case SETTINGS.hideFoundryLogo.tag:\n        SettingsUtil.applyLeftControlsSettings(settingTag, value);\n        break;\n      case SETTINGS.cameraDockMenu.tag: \n        SettingsUtil.applyCameraPosX();\n        SettingsUtil.applyCameraPosY();\n        SettingsUtil.applyCameraWidth();\n        SettingsUtil.applyCameraHeight();\n        break;\n      case SETTINGS.chatBorderColor.tag:\n        ChatUtil.chatBorderColor = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n        LogUtil.log(\"SettingsUtil.apply\",[settingTag]); \n        SettingsUtil.applyBorderColors();\n        break;\n      case SETTINGS.enableChatStyles.tag:\n        ChatUtil.enableChatStyles = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n        LogUtil.log(\"SettingsUtil.apply\",[settingTag]);\n        SettingsUtil.applyChatStyles();\n        break;\n      case SETTINGS.enforceDarkMode.tag:\n        SettingsUtil.resetFoundryThemeSettings();\n        break;\n      case SETTINGS.debugMode.tag:\n        SettingsUtil.applyDebugSettings();\n        break;\n      case SETTINGS.sceneNavMenu.tag:\n        TopNavigation.navSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n        break;\n      case SETTINGS.sceneNavCollapsed.tag:\n        TopNavigation.isCollapsed = SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag);\n        break;\n      case SETTINGS.sceneNavPos.tag:\n        SettingsUtil.applySceneNavPos();\n        break;\n      case SETTINGS.colorTheme.tag:\n        SettingsUtil.applyThemeSettings();\n        break;\n      case SETTINGS.customStyles.tag:\n        SettingsUtil.applyCustomCSS();\n        break;\n      case SETTINGS.adjustOtherModules.tag:\n        SettingsUtil.applyModuleAdjustments();\n        break;\n      default:\n        // do nothing\n    }\n    \n  }\n\n  static applyBorderColors(){\n    const SETTINGS = getSettings();\n    const borderColorSettings = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n    const body = document.querySelector(\"body\");\n\n    if(borderColorSettings===BORDER_COLOR_TYPES.playerColor.name){ \n     body.classList.add(\"player-chat-borders\");\n     body.classList.remove(\"roll-chat-borders\"); \n    }else if(borderColorSettings===BORDER_COLOR_TYPES.rollType.name){\n     body.classList.add(\"roll-chat-borders\"); \n     body.classList.remove(\"player-chat-borders\");\n    }else{\n     body.classList.remove(\"player-chat-borders\");\n     body.classList.remove(\"roll-chat-borders\"); \n    }\n  }\n\n  static applyChatStyles(){\n    const SETTINGS = getSettings();\n    const chatMsgSettings = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n    const body = document.querySelector(\"body\");\n\n    LogUtil.log(\"applyChatStyles\", [chatMsgSettings, SETTINGS]);\n\n    if(chatMsgSettings){ \n      body.classList.add(\"crlngn-chat\"); \n    }else{\n      body.classList.remove(\"crlngn-chat\"); \n    }\n  }\n\n  static applyHotBarSettings(){\n    const SETTINGS = getSettings();\n    const macroSizeOption = SettingsUtil.get(SETTINGS.enableMacroLayout.tag);\n    const hotbar = document.querySelector(\"#hotbar\");\n\n    if(!macroSizeOption && hotbar){\n      hotbar.classList.add(\"foundry-default\");\n    }else if(hotbar){\n      hotbar.classList.remove(\"foundry-default\");\n    }\n  }\n  static applyHotBarCollapse(){\n    const SETTINGS = getSettings();\n    const macroCollapseOption = SettingsUtil.get(SETTINGS.collapseMacroBar.tag);\n\n    if(macroCollapseOption){\n      ui.hotbar.collapse();\n    }\n  }\n\n  /**\n   * Makes changes to left control auto-hide according to selected settings\n   */\n  static applyLeftControlsSettings(tag, value){\n    const SETTINGS = getSettings();\n    const sceneNavMenu = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n    const controls = document.querySelector(\"#ui-left\");\n    const logo = document.querySelector(\"#ui-left #logo\");\n    const body = document.querySelector('body.crlngn-ui');\n    const bodyStyleElem = document.querySelector('#crlngn-ui-vars');\n\n    LogUtil.log(\"applyLeftControlsSettings\", [tag]);\n\n    switch(tag){\n      case SETTINGS.controlsAutoHide.tag:\n        if(SettingsUtil.get(SETTINGS.controlsAutoHide.tag)){\n          controls.classList.add(\"auto-hide\"); \n        }else{\n          controls.classList.remove(\"auto-hide\"); \n        }\n        break;\n      case SETTINGS.hideFoundryLogo.tag:\n        const bodyStyles = window.getComputedStyle(body);\n        const navHeight = bodyStyles.getPropertyValue('--top-nav-height') || '0px';\n        const topPadding = parseFloat(navHeight) || 0;\n        const hideFoundryLogo = SettingsUtil.get(SETTINGS.hideFoundryLogo.tag);\n        LogUtil.log(\"applyLeftControlsSettings\", [tag, topPadding, navHeight]);\n\n        if(hideFoundryLogo===undefined || hideFoundryLogo===true){\n          logo.classList.remove(\"visible\");\n          GeneralUtil.addCSSVars('--ui-top-padding', `${topPadding}px`);\n          document.querySelector(\"body\").classList.remove('logo-visible');\n        } else {\n          logo.classList.add(\"visible\");\n          if(sceneNavMenu.sceneNavEnabled){\n            GeneralUtil.addCSSVars('--ui-top-padding',`${72 + topPadding}px`);\n            document.querySelector(\"body\").classList.add('logo-visible');\n          }else{\n            GeneralUtil.addCSSVars('--ui-top-padding','72px');\n          }\n        }\n        break;\n      case SETTINGS.controlsBottomBuffer.tag:\n        SettingsUtil.applyControlsBuffer();\n        break;\n      case SETTINGS.controlsIconSize.tag:\n        SettingsUtil.applyControlIconSize();\n        break;\n      default:\n        //\n    }\n  }\n  /**\n   * Makes changes to size of icons in left controls according to selected settings\n   */\n  static applyControlIconSize(){\n    const SETTINGS = getSettings();\n    const iconSize = SettingsUtil.get(SETTINGS.controlsIconSize.tag);\n    const body = document.querySelector(\"body\");\n    const size = iconSize == ICON_SIZES.small.name ? ICON_SIZES.small.size : ICON_SIZES.regular.size;\n\n    LogUtil.log(\"applyControlIconSize\", [size]);\n    GeneralUtil.addCSSVars('--left-control-item-size', size);\n    SettingsUtil.applyLeftControlsSettings(SETTINGS.hideFoundryLogo.tag);\n  }\n\n  /**\n   * Apply bottom buffer to left controls \n   */\n  static applyControlsBuffer(){\n    const SETTINGS = getSettings();\n    const leftControls = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    // const root = document.querySelector(\"body.crlngn-ui\");\n    const buffer = isNaN(leftControls.bottomBuffer) ? SETTINGS.leftControlsMenu.default.bottomBuffer : leftControls.bottomBuffer;\n    GeneralUtil.addCSSVars('--controls-bottom-buffer', `${buffer || 0}px`);\n  }\n\n  static applyPlayersListSettings(){\n    const SETTINGS = getSettings();\n    LogUtil.log(\"applyPlayersListSettings\",[document.querySelector(\"#players\"), SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)]); \n    if(SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)){\n      document.querySelector(\"#players\")?.classList.add(\"auto-hide\");\n    }else{\n      document.querySelector(\"#players\")?.classList.remove(\"auto-hide\");\n    }\n    ModuleCompatUtil.checkPlayersList();\n  }\n\n  static applySceneNavPos(value){\n    const SETTINGS = getSettings();\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, value || SettingsUtil.get(SETTINGS.sceneNavPos.tag));\n    TopNavigation.navPos = value || SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n  }\n\n  /**\n   * Apply Camera dock settings\n   */\n  static applyCameraPosX(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const xPos = pos || cameraSettings.dockPosX; \n    CameraUtil.resetPositionAndSize({ x: xPos });\n  }\n  static applyCameraPosY(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const yPos = pos || cameraSettings.dockPosY;\n    CameraUtil.resetPositionAndSize({ y: yPos });\n  }\n  static applyCameraWidth(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const width = value || cameraSettings.dockWidth;\n    CameraUtil.resetPositionAndSize({ w: width });\n  }\n  static applyCameraHeight(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const height = value || cameraSettings.dockHeight;\n    CameraUtil.resetPositionAndSize({ h: height });\n  }\n  /*******/\n\n  static applyCustomFonts(tag, value){\n    const SETTINGS = getSettings();\n    const fields = SETTINGS.customFontsMenu.fields;\n    const customFonts = {};\n\n    LogUtil.log(\"applyCustomFonts\", [tag, value]);\n    fields.forEach(fieldName => {\n      customFonts[fieldName] = SettingsUtil.get(SETTINGS[fieldName].tag);\n    });\n\n    const body = document.querySelector(\"body.crlngn-ui\");\n    switch(tag){\n      case SETTINGS.uiFontBody.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-family', value || customFonts.uiFontBody || SETTINGS.uiFontBody.default.uiFont || '');\n        break;\n      case SETTINGS.uiFontTitles.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-titles', value || customFonts.uiFontTitles || SETTINGS.uiFontTitles.default.uiTitles || '');\n        break;\n      case SETTINGS.journalFontBody.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-journal-body', value || customFonts.journalFontBody || customFonts.journalFontBody || '');\n        break;\n      case SETTINGS.journalFontTitles.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-journal-title', value || customFonts.journalFontTitles || customFonts.journalFontTitles || '');\n        break;\n      default:\n        //\n    }\n  }\n\n  static resetFoundryThemeSettings(){\n    const SETTINGS = getSettings();\n    const isMonksSettingsOn = GeneralUtil.isModuleOn('monks-player-settings');\n    const isForceSettingsOn = GeneralUtil.isModuleOn('force-client-settings');\n    const forceDarkModeOn = SettingsUtil.get(SETTINGS.enforceDarkMode.tag);\n    if(forceDarkModeOn && isMonksSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksPlayerSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n    if(forceDarkModeOn && isForceSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.forceClientSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n\n    const foundryColorScheme = game.settings.get('core','colorScheme');\n\n    LogUtil.log(\"resetFoundryThemeSettings\", [foundryColorScheme, forceDarkModeOn])\n\n    if(foundryColorScheme===false && forceDarkModeOn){\n      game.settings.set('core','colorScheme','dark');\n    }\n  }\n\n  static applyDebugSettings(value){\n    const SETTINGS = getSettings();\n    LogUtil.debugOn = value || SettingsUtil.get(SETTINGS.debugMode.tag);\n  }\n\n  static applyThemeSettings = (value) => {\n    const SETTINGS = getSettings();\n    const themeName = value || SettingsUtil.get(SETTINGS.colorTheme.tag) || \"\";\n    const body = document.querySelector(\"body\");\n\n    LogUtil.log(\"applyThemeSettings\", [value, themeName, SettingsUtil.get(SETTINGS.colorTheme.tag)]);\n    \n    THEMES.forEach((theme)=>{\n      if(theme.className){\n        body.classList.remove(theme.className);\n      }\n    });\n\n    if(themeName){\n      body.classList.add(themeName);\n    }\n  }\n\n  static applyCustomCSS = (value) => {\n    const SETTINGS = getSettings();\n    const cssContent = value || SettingsUtil.get(SETTINGS.customStyles.tag) || \"\";\n\n    GeneralUtil.addCustomCSS(cssContent);\n  }\n\n  static applyModuleAdjustments = (value) => {\n    const SETTINGS = getSettings();\n    const enforceStyles = value || SettingsUtil.get(SETTINGS.adjustOtherModules.tag) || false;\n    const body = document.querySelector(\"body\");\n\n    if(enforceStyles){\n      body.classList.add('crlngn-enforce-styles');\n    }else{\n      body.classList.remove('crlngn-enforce-styles');\n    }\n  }\n\n  static hideInterface = () => {\n    LogUtil.log('hideInterface');\n    const ui = document.querySelector(\"#interface\");\n    const cameraViews = document.querySelector(\"#camera-views\");\n    const taskbar = document.querySelector(\".taskbar\");\n    \n    if(SettingsUtil.#uiHidden){\n      if(ui) ui.style.removeProperty('visibility');\n      if(ui) cameraViews.style.removeProperty('visibility');\n      if(ui) taskbar.style.removeProperty('visibility');\n      SettingsUtil.#uiHidden = false;\n    }else{\n      if(ui) ui.style.setProperty('visibility', 'hidden');\n      if(cameraViews) cameraViews.style.setProperty('visibility', 'hidden');\n      if(taskbar) taskbar.style.setProperty('visibility', 'hidden');\n      SettingsUtil.#uiHidden = true;\n    }\n    \n  }\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\n\nexport class PlayersListUtil {\n\n  static init(){\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, PlayersListUtil.onRender); \n  }\n\n  static onRender(){\n    const playersList = document.querySelector(`aside#players`);\n    const playersTitle = document.querySelector(`aside#players h3:first-child`);\n\n    const playersHeight = playersList.offsetHeight;\n    GeneralUtil.addCSSVars('--players-list-height', playersHeight+'px');\n\n    if(!playersList || !playersTitle){return;}\n    playersTitle.addEventListener('click', ()=>{\n      if(playersList.classList.contains('expanded')){\n        playersList.classList.remove('expanded');\n      }else{\n        playersList.classList.add('expanded');\n      }\n    })\n\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nexport class LeftControls {\n  static #leftControls;\n  static #uiLeft;\n  static #resizeObserver;\n\n  static init(){\n    LogUtil.log(\"LeftControls - init\", []);\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, LeftControls.initSceneControls);\n\n    LeftControls.initSceneControls()\n  } \n\n  static resetLocalVars(){\n    LeftControls.#leftControls = document.querySelector(\"#ui-left #controls\"); \n    LeftControls.#uiLeft = document.querySelector(\"#ui-left\"); \n  }\n\n  static initSceneControls(){\n    LogUtil.log(\"initSceneControls\", [])\n    LeftControls.resetLocalVars();\n    LeftControls.observeControlsWidth();   \n  }\n\n  static observeControlsWidth(){\n    LogUtil.log(\"observeControlsWidth\", []);\n    if(!LeftControls.#leftControls){ return; }\n  \n    let timeout;\n    const throttle = (callback, limit) => {\n      if (!timeout) {\n        timeout = setTimeout(() => {\n          callback();\n          timeout = null;\n        }, limit);\n      }\n    };\n  \n    LeftControls.#resizeObserver = new ResizeObserver(entries => {\n      throttle(() => LeftControls.updateCSSVars(), 250);\n    }, {\n      box: 'border-box'\n    });\n\n    LeftControls.#resizeObserver.observe(LeftControls.#leftControls);\n    LeftControls.updateCSSVars();\n  }\n\n  static updateCSSVars() {\n    if(!LeftControls.#leftControls){ return; }\n\n    let leftOffset = Number(LeftControls.#uiLeft.offsetWidth); \n    let controlsWidth = Number(LeftControls.#leftControls.offsetWidth); \n    let controlsMarginLeft = -leftOffset + controlsWidth + 24;\n    LogUtil.log(\"updateCSSVars\", [controlsWidth, leftOffset]);\n\n    if(!isNaN(controlsWidth) && !isNaN(leftOffset)){\n      GeneralUtil.addCSSVars('--ui-controls-margin-left', controlsMarginLeft + 'px');\n    }\n  }\n}\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\"; \nimport { LogUtil } from \"./LogUtil.mjs\"; \nimport { SettingsUtil } from \"./SettingsUtil.mjs\"; \nimport { TopNavigation } from \"./TopNavUtil.mjs\"; \nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { PlayersListUtil } from \"./PlayersListUtil.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { LeftControls } from \"./LeftControlsUtil.mjs\";\nimport { MODULE_ID } from \"../constants/General.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { ModuleCompatUtil } from \"./ModuleCompatUtil.mjs\";\nimport { SceneNavFolders } from \"./SceneFoldersUtil.mjs\";\n\nexport class Main {\n\n  static init(){\n    Hooks.once(HOOKS_CORE.INIT, () => { \n      document.querySelector(\"#ui-middle\")?.classList.add(MODULE_ID);\n\n      LogUtil.log(\"Initiating module...\", [], true); \n\n      Hooks.on(HOOKS_CORE.RENDER_CHAT_MESSAGE, Main.#onRenderChatMessage); \n      // Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, Main.checkPlayersList);\n      // Hooks.on(HOOKS_CORE.RENDER_HOTBAR, Main.checkPlayersList);\n      SettingsUtil.registerSettings();\n      TopNavigation.init(); \n      CameraUtil.init(); \n      PlayersListUtil.init(); \n      LeftControls.init();\n      ChatUtil.init();\n    });\n\n    Hooks.once(HOOKS_CORE.READY, () => {\n      LogUtil.log(\"Core Ready\", []);\n      const SETTINGS = getSettings();\n      var isDebugOn = SettingsUtil.get(SETTINGS.debugMode.tag);\n      if(isDebugOn){CONFIG.debug.hooks = true};\n\n      // TopNavigation.init(); \n      // CameraUtil.init(); \n      // PlayersListUtil.init(); \n      // LeftControls.init();\n      // ChatUtil.init();\n      ModuleCompatUtil.init();\n\n      const chatStylesEnabled = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n      if(chatStylesEnabled){ \n        Main.addCSSLocalization();\n      }\n      SettingsUtil.resetFoundryThemeSettings();\n      // SettingsUtil.applyThemeSettings();\n      \n    })\n  }\n\n  // Custom labels for DnD5e buttons, added via CSS\n  static addCSSLocalization(){\n    const locBtnPath = 'CRLNGN_UI.dnd5e.chatCard.buttons';\n    \n    GeneralUtil.addCSSVars('--crlngn-i18n-attack', game.i18n.localize(`${locBtnPath}.attack`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-damage', game.i18n.localize(`${locBtnPath}.damage`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-summons', game.i18n.localize(`${locBtnPath}.summons`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-healing', game.i18n.localize(`${locBtnPath}.healing`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-template', game.i18n.localize(`${locBtnPath}.template`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-consume', game.i18n.localize(`${locBtnPath}.consume`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-refund', game.i18n.localize(`${locBtnPath}.refund`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-macro', game.i18n.localize(`${locBtnPath}.macro`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-save-dc', game.i18n.localize(`${locBtnPath}.savedc`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-save', game.i18n.localize(`${locBtnPath}.save`));\n  }\n\n  static #onRenderChatMessage = (chatMessage, html) => { \n    LogUtil.log(HOOKS_CORE.RENDER_CHAT_MESSAGE,[chatMessage, html]);\n  \n    ChatUtil.enrichCard(chatMessage, html);\n  }\n\n}\n","import \"./styles/vars.css\";\n\nimport \"./styles/main.css\";\n\nimport \"./styles/ui-middle.css\";\nimport \"./styles/ui-top.css\";\n\nimport \"./styles/ui-right.css\";\nimport \"./styles/ui-left.css\";\n\nimport \"./styles/ui-bottom.css\";\n\nimport \"./styles/camera.css\";\nimport \"./styles/chat.css\";\n\nimport \"./styles/players-list.css\";\nimport \"./styles/other-modules.css\"; \n\n\n\nimport { Main } from \"./components/Main.mjs\";\n\nMain.init();"],"names":["HOOKS_CORE","MODULE_ID","DEBUG_TAG","_LogUtil","ref","data","bypassSettings","debugSetting","strRef","options","_a","__publicField","LogUtil","SETTING_INPUT","SETTING_SCOPE","ICON_SIZES","BORDER_COLOR_TYPES","THEMES","getSettings","ApplicationV2","HandlebarsApplicationMixin","_CameraDockSettings_static","onSubmit_fn","onReset_fn","_CameraDockSettings","__privateMethod","SETTINGS","setting","SettingsUtil","partId","context","event","form","formData","controlSettings","isFloating","settings","a","b","inputs","defaults","inputField","__privateAdd","CameraDockSettings","_ChatMessagesSettings_static","_ChatMessagesSettings","menuValues","fieldNames","fields","fieldValues","fieldDefaults","fieldName","value","currBorderSettings","ChatMessagesSettings","GeneralUtil","moduleName","module","parent","selector","element","offsetTop","elementHeight","offsetParent","Class","staticMethodNames","prop","methodName","originalMethod","args","protoMethodNames","foundryFonts","customFontsObj","customFonts","fontFamily","cssImportedFonts","sheet","cssText","rules","rule","e","importUrlRegex","match","url","familyMatch","family","response","fontFamilyMatch","f","fontName","cleanName","varName","varValue","bodyStyle","body","ruleStart","ruleEnd","declarations","decl","varsMap","parts","name","newRuleContent","newCss","content","customStyle","_element","_CustomFontsSettings_static","closeAllDropdowns_fn","_CustomFontsSettings","__privateSet","__privateGet","input","wrapper","dropdown","onFocus","isActive","currentIndex","opt","option","CustomFontsSettings","_LeftControlsSettings_static","_LeftControlsSettings","LeftControlsSettings","_SceneNavSettings_static","_SceneNavSettings","menuSettings","navEnabled","SceneNavSettings","_ThemeAndStyleSettings_static","_ThemeAndStyleSettings","selectedTheme","theme","dropOptions","that","span","i","ThemeAndStyleSettings","getSettingMenus","_offsetX","_offsetY","_startX","_startY","_startWidth","_startHeight","_startBottom","_CameraUtil_static","onDragRelease_fn","onDragMove_fn","onResize_fn","onStopResize_fn","_CameraUtil","cameraSettings","_b","_c","controlsElem","cameraGrid","camControls","existingButtons","controlBar","btnToggle","offsetBottom","resizeHandle","x","y","w","h","savedPosX","savedPosY","savedWidth","savedHeight","left","bottom","newWidth","deltaY","newHeight","newBottom","_d","_e","_f","CameraUtil","_ChatUtil","chatMessage","html","_g","_h","_i","rollType","chatItem","tempElement","saveButtons","button","visibleDCSpan","hiddenDCSpan","ChatUtil","_checkPlayersTimeout","_ModuleCompatUtil","isTaskbarOn","taskbarFlag","taskbarReduceSidebar","ftMoveStyle","uiLeftPlayers","isPlayersDocked","isMacroDocked","timeoutDelay","hotbar","ModuleCompatUtil","DEFAULT_FOLDER_ID","_SceneNavFolders","id","fd","folder","fromList","folders","folderList","templatePath","fc","folderElement","templateData","renderedHtml","targetElement","insertedHtml","toggleSpan","subfoldersOl","fi","evt","target","SceneNavFolders","_navElem","_scenesList","_navTimeout","_navExtras","_navToggle","_uiMiddle","_timeout","_collapseTimeout","_onNavLast","_onNavNext","_TopNavigation","collapsed","list","isNavOverflowing","btnLast","arrowLeft","btnNext","arrowRight","pos","position","scenes","newMargin","uiMiddle","navSettings","isMonksScenenNavOn","c","d","nav","toggleWidth","extrasWidth","firstScene","itemWidth","currPos","itemsPerPage","newPos","TopNavigation","_uiHidden","_SettingsUtil","entry","settingObj","settingMenu","settingMenuObj","settingName","selectedSetting","newValue","settingTag","borderColorSettings","chatMsgSettings","macroSizeOption","tag","sceneNavMenu","controls","logo","navHeight","topPadding","hideFoundryLogo","iconSize","size","leftControls","buffer","xPos","yPos","width","height","isMonksSettingsOn","isForceSettingsOn","forceDarkModeOn","foundryColorScheme","themeName","cssContent","enforceStyles","ui","cameraViews","taskbar","PlayersListUtil","playersList","playersTitle","playersHeight","_leftControls","_uiLeft","_resizeObserver","_LeftControls","timeout","throttle","callback","limit","entries","leftOffset","controlsWidth","controlsMarginLeft","LeftControls","_onRenderChatMessage","_Main","isDebugOn","locBtnPath","Main"],"mappings":"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"}